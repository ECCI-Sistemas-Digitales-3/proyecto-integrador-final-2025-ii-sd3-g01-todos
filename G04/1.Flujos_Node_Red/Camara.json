[
    {
        "id": "ed7a9d6c1892219f",
        "type": "tab",
        "label": "Flow 1",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "287e47dc468b289d",
        "type": "tab",
        "label": "Camera",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "f5959909f7027465",
        "type": "tab",
        "label": "Lab",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "bcaa4e4248dbdbb8",
        "type": "tab",
        "label": "Camera_2",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "f01b2326bc102ff4",
        "type": "tab",
        "label": "Camara_color",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "1142a758c3b277ef",
        "type": "tab",
        "label": "GALGA",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "934d5fc036780bc6",
        "type": "tab",
        "label": "Báscula ESP32 (ngrok)",
        "disabled": true,
        "info": ""
    },
    {
        "id": "cdf677c5e1a7be6e",
        "type": "tab",
        "label": "Básculas ESP32 y MQTT",
        "disabled": true,
        "info": "Flujo para visualizar las 5 galgas (lectura) y enviar el comando TARA (botón) a cada una."
    },
    {
        "id": "dc25c51e2f8bdb1b",
        "type": "tab",
        "label": "Bomba Negra",
        "disabled": true,
        "info": ""
    },
    {
        "id": "8167fc72ca67c031",
        "type": "tab",
        "label": "BOMBASSS",
        "disabled": true,
        "info": ""
    },
    {
        "id": "1e029c11f34910f2",
        "type": "tab",
        "label": "Bombas",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "a38a6f1d49ba3af3",
        "type": "tab",
        "label": "Mezclador",
        "disabled": true,
        "info": ""
    },
    {
        "id": "4baa40181dbb5c48",
        "type": "tab",
        "label": "Sensor de Color TCS34725",
        "disabled": false,
        "info": ""
    },
    {
        "id": "bdbe7f8f0b413356",
        "type": "tab",
        "label": "TemperaturaSensor",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "bda4c729604855f5",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "633db782b5e59011",
        "type": "tab",
        "label": "Camara_color",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "cde7aa63dafca91c",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "5e6b2679245e12a9",
        "type": "ui_tab",
        "name": "Camera",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "66000ecd71d983c2",
        "type": "ui_group",
        "z": "287e47dc468b289d",
        "name": "Default",
        "tab": "5e6b2679245e12a9",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "a910725792e783fc",
        "type": "ui-theme",
        "name": "Default Theme",
        "colors": {
            "surface": "#ffffff",
            "primary": "#0094CE",
            "bgPage": "#eeeeee",
            "groupBg": "#ffffff",
            "groupOutline": "#cccccc"
        },
        "sizes": {
            "density": "default",
            "pagePadding": "12px",
            "groupGap": "12px",
            "groupBorderRadius": "4px",
            "widgetGap": "12px"
        }
    },
    {
        "id": "9b7de2fc71e25597",
        "type": "ui_group",
        "name": "Group 1",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": 6
    },
    {
        "id": "215d16062f6aa65a",
        "type": "ui_tab",
        "name": "Camera_2",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d6fc9e38f3c6205a",
        "type": "ui_group",
        "name": "Images",
        "tab": "215d16062f6aa65a",
        "order": 1,
        "disp": true,
        "width": 17,
        "collapse": false,
        "className": ""
    },
    {
        "id": "grp-ui",
        "type": "ui_group",
        "name": "Controles",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "tab-ui",
        "type": "ui_tab",
        "name": "Laboratorio",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "9ecf55ce9bfe3bf2",
        "type": "ui_group",
        "name": "Default",
        "tab": "5e6b2679245e12a9",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c5a1cae69f12010b",
        "type": "ui_tab",
        "name": "Prueba",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "763743ce3b9f30a9",
        "type": "ui_group",
        "name": "Default",
        "tab": "c5a1cae69f12010b",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "0f36ae3e92f1ccb9",
        "type": "ui-group",
        "name": "Group Name",
        "page": "",
        "width": 6,
        "height": 1,
        "order": -1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false",
        "groupType": "default"
    },
    {
        "id": "0be5612562bbf243",
        "type": "ui_tab",
        "name": "Jesus",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d5368e4d0d6e6d48",
        "type": "ui_group",
        "name": "Default",
        "tab": "0be5612562bbf243",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "89b5767d2d6aab10",
        "type": "mqtt-broker",
        "name": "servirdor",
        "broker": "10.76.198.163",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "dcd18b8045b3ee39",
        "type": "ui_tab",
        "name": "Camara_color",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "180082cf2286b03f",
        "type": "mqtt-broker",
        "name": "GALGA LINK",
        "broker": "6.tcp.ngrok.io",
        "port": "13349",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "549c02f252798d40",
        "type": "ui_tab",
        "name": "GALGA",
        "icon": "dashboard",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "6511f5347db4bf39",
        "type": "ui_group",
        "name": "Group 1",
        "tab": "549c02f252798d40",
        "order": 1,
        "disp": true,
        "width": 6
    },
    {
        "id": "64236f01351959f5",
        "type": "ui_group",
        "name": "camara_color",
        "tab": "dcd18b8045b3ee39",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "b1c2d3e4.f5a6b7",
        "type": "mqtt-broker",
        "name": "HiveMQ Public Broker",
        "broker": "broker.hivemq.com",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "compatmode": false,
        "protocolVersion": 4,
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "t5a6b7c8.d9e0f1",
        "type": "ui_tab",
        "name": "Báscula",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "g1h2j3k4.l5m6n7",
        "type": "ui_group",
        "name": "Control Báscula",
        "tab": "t5a6b7c8.d9e0f1",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "f5bb53dfb5cccc7f",
        "type": "mqtt-broker",
        "name": "Mosquitto via ngrok",
        "broker": "6.tcp.ngrok.io",
        "port": "16550",
        "clientid": "NodeRED_Client_Bascula",
        "autoConnect": true,
        "usetls": false,
        "compatmode": false,
        "protocolVersion": 4,
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "e2401f95.5d9e5",
        "type": "mqtt-broker",
        "name": "ESP32 Básculas Broker",
        "broker": "4.tcp.ngrok.io",
        "port": "12647",
        "clientid": "node_red_client_basculas",
        "autoConnect": true,
        "usetls": false,
        "compatmode": false,
        "protocolVersion": 4,
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "11fe462.6a147e",
        "type": "ui_tab",
        "name": "Panel Básculas",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "c13d8d6.b38c26",
        "type": "ui_group",
        "name": "Control y Lecturas de Básculas",
        "tab": "11fe462.6a147e",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "e1f2a3b4.c5d6e7",
        "type": "ui_tab",
        "name": "Báscula",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f1a2b3c4.d5e6f7",
        "type": "ui_group",
        "name": "Gráfico Comparativo",
        "tab": "e1f2a3b4.c5d6e7",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "h1i2j3k4.l5m6n7",
        "type": "ui_group",
        "name": "Control",
        "tab": "e1f2a3b4.c5d6e7",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "b1a2d3e4.5f67a",
        "type": "mqtt-broker",
        "name": "Ngrok Broker",
        "broker": "6.tcp.ngrok.io",
        "port": "16550",
        "clientid": "NodeRED_Client_Basc}",
        "usetls": false,
        "compatmode": false,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "c1d2e3f4.a7b8c9",
        "type": "ui_group",
        "name": "Lectura de Galgas",
        "tab": "e1f2a3b4.c5d6e7",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "138c9e1c6a6f1c8e",
        "type": "mqtt-broker",
        "name": "localhost:1883",
        "broker": "localhost",
        "port": 1883,
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "2eb5066e18d79653",
        "type": "ui_tab",
        "name": "Bomba_Negra_Test",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "5aaa12e4a452036e",
        "type": "ui_tab",
        "name": "Bombassss",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "0d7198bbbc68d529",
        "type": "ui_group",
        "name": "Bomba Negra",
        "tab": "5aaa12e4a452036e",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ui_blanca",
        "type": "ui_group",
        "name": "Bomba Blanca",
        "tab": "5aaa12e4a452036e",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ui_azul",
        "type": "ui_group",
        "name": "Bomba Azul",
        "tab": "5aaa12e4a452036e",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "6735fef8e0262102",
        "type": "ui_group",
        "name": "Bomba Amarilla",
        "tab": "5aaa12e4a452036e",
        "order": 4,
        "disp": true,
        "width": 6
    },
    {
        "id": "ui_group_roja",
        "type": "ui_group",
        "name": "Bomba Roja",
        "tab": "5aaa12e4a452036e",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2c5b539e522b2721",
        "type": "mqtt-broker",
        "name": "",
        "broker": "6.tcp.ngrok.io ",
        "port": "13349",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "6605b0b68657e7c0",
        "type": "ui_tab",
        "name": "BOMBAS",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "dae114c04a396a81",
        "type": "ui_group",
        "name": "DSB Bombas",
        "tab": "6605b0b68657e7c0",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "bd0e2e04f12ac3cb",
        "type": "mqtt-broker",
        "name": "8.tcp.ngrok.io:12777",
        "broker": "8.tcp.ngrok.io",
        "port": "12777",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "3e798ae9bba470cc",
        "type": "ui_tab",
        "name": "Mezclador",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "435156eae1fe1a22",
        "type": "ui_group",
        "name": "Motor Agitador",
        "tab": "3e798ae9bba470cc",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "1fc3c77d74f3a787",
        "type": "ui_group",
        "name": "Motor Elevador",
        "tab": "3e798ae9bba470cc",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "8acadf27340987d8",
        "type": "ui_tab",
        "name": "Camara_color",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "84927e3066e79b05",
        "type": "ui_tab",
        "name": "Sensor Color TCS34725",
        "icon": "palette",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "0680cbe3d040e0fd",
        "type": "mqtt-broker",
        "name": "localhost:1883",
        "broker": "localhost",
        "port": 1883,
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "3afcbf09e13607ae",
        "type": "ui_tab",
        "name": "Camara_color",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "1d209e32fcbace19",
        "type": "ui_tab",
        "name": "Temperatura",
        "icon": "dashboard",
        "order": 6,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f0b91852e4d33cff",
        "type": "ui_group",
        "name": "Temperatura",
        "tab": "3afcbf09e13607ae",
        "order": 4,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "42b625a52eaeccee",
        "type": "ui_group",
        "name": "Resistencias",
        "tab": "3afcbf09e13607ae",
        "order": 5,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "6069fce9c8d0f810",
        "type": "ui_group",
        "name": "temperatura",
        "tab": "1d209e32fcbace19",
        "order": 1,
        "disp": true,
        "width": 19,
        "collapse": false,
        "className": ""
    },
    {
        "id": "0dbc51b5a13e11e4",
        "type": "ui_group",
        "name": "camara_color",
        "tab": "3afcbf09e13607ae",
        "order": 1,
        "disp": true,
        "width": "11",
        "collapse": true,
        "className": ""
    },
    {
        "id": "ce827108bd6b0f32",
        "type": "ui_group",
        "name": "Sensor_color",
        "tab": "3afcbf09e13607ae",
        "order": 3,
        "disp": true,
        "width": "10",
        "collapse": true,
        "className": ""
    },
    {
        "id": "540b95c327a70dcf",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "129cb8d97fa55a95",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "b20bf45c645d1b0f",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "79ea957ac52a6602",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "eee338254305021d",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 10,
        "width": 1,
        "height": 1
    },
    {
        "id": "a113e1028f4bd2bf",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "3a7958e6a8207c6c",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 12,
        "width": 1,
        "height": 1
    },
    {
        "id": "37372338fd807bdc",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "a3a8dde0e1e13e3f",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 14,
        "width": 1,
        "height": 1
    },
    {
        "id": "ef4585fde9aa195b",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 15,
        "width": 1,
        "height": 1
    },
    {
        "id": "ee2f7e7eb829ee96",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 16,
        "width": 1,
        "height": 1
    },
    {
        "id": "8ed9d6f6a4f0e35f",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 17,
        "width": 1,
        "height": 1
    },
    {
        "id": "b23eabf4e24c2c1f",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 18,
        "width": 1,
        "height": 1
    },
    {
        "id": "4d6292014923b12e",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 19,
        "width": 1,
        "height": 1
    },
    {
        "id": "6ffe1c4b34cfe33a",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 20,
        "width": 1,
        "height": 1
    },
    {
        "id": "743cc8e7a68695b6",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 21,
        "width": 1,
        "height": 1
    },
    {
        "id": "33e13e6814d5f6af",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 22,
        "width": 1,
        "height": 1
    },
    {
        "id": "376ea720e335170f",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 23,
        "width": 1,
        "height": 1
    },
    {
        "id": "20b0ad1be1ba419e",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 24,
        "width": 1,
        "height": 1
    },
    {
        "id": "df110534bc5cc0f9",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 25,
        "width": 1,
        "height": 1
    },
    {
        "id": "2cf6a3465fe7da57",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 26,
        "width": 1,
        "height": 1
    },
    {
        "id": "2ab76564b887f598",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 27,
        "width": 1,
        "height": 1
    },
    {
        "id": "15b93db9f6a30b41",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 28,
        "width": 1,
        "height": 1
    },
    {
        "id": "433aaf06bbcb63a0",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 29,
        "width": 1,
        "height": 1
    },
    {
        "id": "6257f1daf79307f6",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 30,
        "width": 19,
        "height": 1
    },
    {
        "id": "1a575836c683ad00",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 32,
        "width": 1,
        "height": 1
    },
    {
        "id": "418e7d3b56f119ae",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 34,
        "width": 1,
        "height": 1
    },
    {
        "id": "745502bead4f0f9d",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 36,
        "width": 1,
        "height": 1
    },
    {
        "id": "a6f2828a8ec57c2a",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 38,
        "width": 1,
        "height": 1
    },
    {
        "id": "33fb42503b6f67fd",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 40,
        "width": 19,
        "height": 1
    },
    {
        "id": "d50c7977b6131fb9",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 41,
        "width": 19,
        "height": 1
    },
    {
        "id": "707090490edc0ea0",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 42,
        "width": 19,
        "height": 1
    },
    {
        "id": "d54cc12168761cbf",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "6069fce9c8d0f810",
        "order": 43,
        "width": 19,
        "height": 1
    },
    {
        "id": "7e7ff49c9085e7b2",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "0dbc51b5a13e11e4",
        "order": 1,
        "width": 1,
        "height": 1
    },
    {
        "id": "4917e8e00adabc88",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "ce827108bd6b0f32",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "7ee7c389f2843b72",
        "type": "ui_spacer",
        "z": "bdbe7f8f0b413356",
        "name": "spacer",
        "group": "ce827108bd6b0f32",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "34dc4380d806bb6b",
        "type": "ui_group",
        "name": "Bomba Negra",
        "tab": "2eb5066e18d79653",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "8670a6f1862a55ea",
        "type": "ui_group",
        "name": "Sensor_color",
        "tab": "8acadf27340987d8",
        "order": 3,
        "disp": true,
        "width": "10",
        "collapse": true,
        "className": ""
    },
    {
        "id": "b58653233d44b4ca",
        "type": "ui_group",
        "name": "Sensor de Color",
        "tab": "84927e3066e79b05",
        "order": 1,
        "disp": false,
        "width": 25,
        "collapse": false,
        "className": ""
    },
    {
        "id": "d9937c74942ba2f6",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 1,
        "width": 5,
        "height": 1
    },
    {
        "id": "45472986dd1db4b2",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 5,
        "width": 5,
        "height": 1
    },
    {
        "id": "6a11a696b8a56601",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 6,
        "width": 5,
        "height": 1
    },
    {
        "id": "c6991ed10b2c6102",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 7,
        "width": 5,
        "height": 1
    },
    {
        "id": "148151ed5c8a4acf",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 8,
        "width": 5,
        "height": 1
    },
    {
        "id": "63f2c3c361db9b8a",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 9,
        "width": 5,
        "height": 1
    },
    {
        "id": "9b978672f3db9242",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 10,
        "width": 5,
        "height": 1
    },
    {
        "id": "4771ff0c21003d81",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 11,
        "width": 5,
        "height": 1
    },
    {
        "id": "015d15943794f96c",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 12,
        "width": 5,
        "height": 1
    },
    {
        "id": "299cf328ac2bc708",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 14,
        "width": 5,
        "height": 1
    },
    {
        "id": "a2e3eb560be2379a",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 15,
        "width": 5,
        "height": 1
    },
    {
        "id": "2f7e4121e35e8f76",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 16,
        "width": 5,
        "height": 1
    },
    {
        "id": "273cd67dfa2add7e",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 17,
        "width": 5,
        "height": 1
    },
    {
        "id": "f1032cce89aad631",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 18,
        "width": 5,
        "height": 1
    },
    {
        "id": "efa94bfde8a20b66",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 19,
        "width": 5,
        "height": 1
    },
    {
        "id": "ac1aefb949b62bdc",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 20,
        "width": 5,
        "height": 1
    },
    {
        "id": "933259717be00f57",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 21,
        "width": 5,
        "height": 1
    },
    {
        "id": "dce3ea213e763df2",
        "type": "ui_spacer",
        "z": "4baa40181dbb5c48",
        "name": "spacer",
        "group": "b58653233d44b4ca",
        "order": 22,
        "width": 5,
        "height": 1
    },
    {
        "id": "20054df736a9fdc0",
        "type": "ui_tab",
        "name": "Color",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "eacc0ebccf0ac856",
        "type": "ui_group",
        "name": "Default",
        "tab": "20054df736a9fdc0",
        "order": 1,
        "disp": true,
        "width": 25,
        "collapse": false,
        "className": ""
    },
    {
        "id": "d93d769ab134dcae",
        "type": "mqtt-broker",
        "name": "",
        "broker": "192.168.155.216",
        "port": 1883,
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "e8ea7b278b0df30e",
        "type": "debug",
        "z": "ed7a9d6c1892219f",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 420,
        "y": 280,
        "wires": []
    },
    {
        "id": "5ce70529fcdf7112",
        "type": "inject",
        "z": "ed7a9d6c1892219f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "10",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Hello",
        "payloadType": "str",
        "x": 190,
        "y": 260,
        "wires": [
            [
                "e8ea7b278b0df30e"
            ]
        ]
    },
    {
        "id": "c7c1b02775bff674",
        "type": "camerapi-takephoto",
        "z": "287e47dc468b289d",
        "filemode": "1",
        "filename": "photo1.JPEG",
        "filedefpath": "0",
        "filepath": "",
        "fileformat": "jpeg",
        "resolution": "9",
        "rotation": "0",
        "fliph": "0",
        "flipv": "0",
        "brightness": "50",
        "contrast": "0",
        "sharpness": "0",
        "quality": "80",
        "imageeffect": "none",
        "exposuremode": "auto",
        "iso": "0",
        "agcwait": "1.0",
        "led": "0",
        "awb": "auto",
        "name": "",
        "x": 440,
        "y": 240,
        "wires": [
            [
                "628eb71a13967a99"
            ]
        ]
    },
    {
        "id": "628eb71a13967a99",
        "type": "debug",
        "z": "287e47dc468b289d",
        "name": "msg",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 240,
        "wires": []
    },
    {
        "id": "ce4b3f3155e4cdb1",
        "type": "ui_template",
        "z": "287e47dc468b289d",
        "group": "66000ecd71d983c2",
        "name": "",
        "order": 0,
        "width": 0,
        "height": 0,
        "format": "<script>\nvar value = \"1\";\n// or overwrite value in your callback function ...\nthis.scope.action = function() { return value; }\n\nfunction updateF() {\n  var source = '/photo1.JPEG',\n  timestamp = (new Date()).getTime(),\n  newUrl = source + '?_=' + timestamp;\n  document.getElementById(\"photo\").src = newUrl;\n}\n</script>\n\n<md-button ng-click=\"send({payload:action()})\" onclick=\"setTimeout(updateF, 2500);\" style=\"padding:40px; margin-bottom: 40px;\" >\n <ui-icon icon=\"camera\"></ui-icon>\n Take a photo<br>\n</md-button>\n\n<div style=\"margin-bottom:40px;\">\n <img src=\"/photo1.JPEG\" id=\"photo\" width=\"100%\" height=\"100%\">\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 220,
        "y": 240,
        "wires": [
            [
                "c7c1b02775bff674",
                "c71e3475baf35c94"
            ]
        ]
    },
    {
        "id": "c71e3475baf35c94",
        "type": "debug",
        "z": "287e47dc468b289d",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 300,
        "wires": []
    },
    {
        "id": "99ba6fb971b9ecf1",
        "type": "exec",
        "z": "287e47dc468b289d",
        "command": "cd mediamtx && ./mediamtx",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 560,
        "y": 80,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "981ef957a2f09da6",
        "type": "ui_button",
        "z": "287e47dc468b289d",
        "name": "",
        "group": "66000ecd71d983c2",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "button",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 250,
        "y": 160,
        "wires": [
            [
                "99ba6fb971b9ecf1"
            ]
        ]
    },
    {
        "id": "099fb4cd12f543b8",
        "type": "inject",
        "z": "287e47dc468b289d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 80,
        "wires": [
            [
                "99ba6fb971b9ecf1"
            ]
        ]
    },
    {
        "id": "378f106242abcc3f",
        "type": "ui_template",
        "z": "287e47dc468b289d",
        "group": "66000ecd71d983c2",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<script src=\"https://cdn.jsdelivr.net/npm/hls.js@latest\"></script>\n\n<video id=\"hlsVideo\" width=\"640\" height=\"360\" controls autoplay muted></video>\n\n<script>\n  const video = document.getElementById('hlsVideo');\n  const videoSrc = \"http://192.168.80.23:8888/cam/index.m3u8\";\n\n  if (Hls.isSupported()) {\n    const hls = new Hls();\n    hls.loadSource(videoSrc);\n    hls.attachMedia(video);\n    hls.on(Hls.Events.MANIFEST_PARSED, function () {\n      video.play();\n    });\n    hls.on(Hls.Events.ERROR, function (event, data) {\n      console.error(\"HLS.js error\", data);\n    });\n  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {\n    video.src = videoSrc;\n    video.addEventListener('loadedmetadata', function () {\n      video.play();\n    });\n  } else {\n    alert(\"Tu navegador no soporta video HLS\");\n  }\n</script>\n\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 820,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "9179e9b791c51b03",
        "type": "ui_template",
        "z": "287e47dc468b289d",
        "group": "66000ecd71d983c2",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<style>\n    #picker-canvas-{{$id}} {\n        width: 100%;\n        height: auto;\n        /* El cursor 'crosshair' (cruz) sigue siendo ideal */\n        cursor: crosshair;\n        background-color: #eee;\n        border: 1px solid #999;\n    }\n    #picker-info-{{$id}} {\n        margin-top: 10px;\n        font-family: monospace;\n        font-size: 16px;\n        display: flex;\n        align-items: center;\n    }\n    #picker-swatch-{{$id}} {\n        display: inline-block;\n        width: 25px;\n        height: 25px;\n        border: 1px solid #000;\n        vertical-align: middle;\n        margin-right: 10px;\n        background-color: #fff;\n    }\n</style>\n\n<canvas id=\"picker-canvas-{{$id}}\"></canvas>\n<div id=\"picker-info-{{$id}}\">\n    <span id=\"picker-swatch-{{$id}}\"></span>\n    <span id=\"picker-rgb-{{$id}}\">(R, G, B)</span>\n</div>\n\n<script>\n(function(scope) {\n    // Referencias a elementos HTML\n    var canvas = document.getElementById('picker-canvas-{{$id}}');\n    var ctx = canvas.getContext('2d');\n    var swatch = document.getElementById('picker-swatch-{{$id}}');\n    var rgbText = document.getElementById('picker-rgb-{{$id}}');\n\n    var img = new Image();\n    img.crossOrigin = \"Anonymous\";\n\n    // Función para cargar/recargar la imagen\n    function updateImage() {\n        // Usamos el \"cache buster\" para forzar la recarga de la imagen\n        img.src = '/test.png?' + new Date().getTime();\n    }\n\n    // Cuando la imagen se carga...\n    img.onload = function() {\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n        ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);\n        \n        // Limpiamos los valores al cargar una nueva foto\n        swatch.style.backgroundColor = \"#fff\";\n        rgbText.textContent = \"(R, G, B)\";\n    };\n    \n    img.onerror = function() {\n        console.error(\"No se pudo cargar la imagen /test.png\");\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.font = \"16px Arial\";\n        ctx.fillStyle = \"red\";\n        ctx.fillText(\"Error al cargar /test.png\", 10, 30);\n    };\n\n    // ======================================================\n    //  CAMBIO PRINCIPAL: Usamos 'click' en lugar de 'mousemove'\n    // ======================================================\n    canvas.addEventListener('click', function(event) {\n        // --- Lógica de Escala (idéntica) ---\n        var rect = canvas.getBoundingClientRect(); \n        var scaleX = canvas.width / rect.width;\n        var scaleY = canvas.height / rect.height;\n        \n        var x = Math.floor(event.offsetX * scaleX);\n        var y = Math.floor(event.offsetY * scaleY);\n        \n        // --- Obtener el Color (idéntico) ---\n        var pixelData = ctx.getImageData(x, y, 1, 1).data;\n        \n        var r = pixelData[0];\n        var g = pixelData[1];\n        var b = pixelData[2];\n        \n        // --- Actualizar la UI (idéntico) ---\n        var rgbString = `rgb(${r}, ${g}, ${b})`;\n        swatch.style.backgroundColor = rgbString;\n        rgbText.textContent = `(${r}, ${g}, ${b})  [${x}, ${y}]`;\n    });\n    \n    // ======================================================\n    //  CAMBIO PRINCIPAL: Se eliminó el evento 'mouseleave'\n    //  (Ya no reseteamos el color cuando el ratón sale)\n    // ======================================================\n\n    // Esta función se ejecuta CADA VEZ que un 'msg' llega al nodo\n    scope.$watch('msg', function(msg) {\n        if (msg) {\n            updateImage();\n        }\n    });\n\n    // Carga la imagen la primera vez\n    setTimeout(updateImage, 100);\n\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1160,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "aa55d23adadb60f1",
        "type": "function",
        "z": "287e47dc468b289d",
        "name": "function 1",
        "func": "// Añade una marca de tiempo para forzar la recarga de la imagen\n// Apuntamos a /test.png, como pediste.\nmsg.url = \"/test.png?t=\" + Date.now();\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 400,
        "wires": [
            [
                "9179e9b791c51b03"
            ]
        ]
    },
    {
        "id": "c20d46f7768669f6",
        "type": "inject",
        "z": "287e47dc468b289d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 750,
        "y": 400,
        "wires": [
            [
                "aa55d23adadb60f1"
            ]
        ]
    },
    {
        "id": "color-picker",
        "type": "ui_colour_picker",
        "z": "f5959909f7027465",
        "name": "Color",
        "label": "Selecciona color",
        "group": "d5368e4d0d6e6d48",
        "format": "hex",
        "outformat": "string",
        "showSwatch": true,
        "showPicker": true,
        "showValue": true,
        "showHue": false,
        "showAlpha": false,
        "showLightness": true,
        "square": "false",
        "width": "",
        "height": "",
        "passthru": true,
        "topic": "ui/color",
        "topicType": "str",
        "className": "",
        "x": 410,
        "y": 160,
        "wires": [
            [
                "fn-hex2rgb"
            ]
        ]
    },
    {
        "id": "fn-hex2rgb",
        "type": "function",
        "z": "f5959909f7027465",
        "name": "HEX → RGB + texto",
        "func": "// Espera msg.payload como string tipo \"#RRGGBB\"\nlet hex = String(msg.payload || \"\").trim();\nif (!/^#?[0-9a-fA-F]{6}$/.test(hex)) {\n  node.warn(\"Formato HEX inválido: \" + hex);\n  return null;\n}\nif (hex[0] === '#') hex = hex.slice(1);\nconst r = parseInt(hex.slice(0,2), 16);\nconst g = parseInt(hex.slice(2,4), 16);\nconst b = parseInt(hex.slice(4,6), 16);\n\n// Mostramos RGB en UI\nmsg.payload = `${r}, ${g}, ${b}`;\nmsg.rgb = { r, g, b };\n\n// Para archivo: agregamos timestamp y CSV simple\nconst ts = new Date().toISOString();\nmsg.filePayload = `${ts};${r};${g};${b}`;\nreturn [msg];",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 160,
        "wires": [
            [
                "ui-text",
                "to-file"
            ]
        ]
    },
    {
        "id": "ui-text",
        "type": "ui_text",
        "z": "f5959909f7027465",
        "group": "d5368e4d0d6e6d48",
        "order": 2,
        "width": "6",
        "height": "1",
        "name": "Valores RGB",
        "label": "RGB",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 930,
        "y": 140,
        "wires": []
    },
    {
        "id": "to-file",
        "type": "file",
        "z": "f5959909f7027465",
        "name": "Guardar en archivo",
        "filename": "/home/pi/labs/rgb_log.txt",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 970,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "5d8890673a28a704",
        "type": "inject",
        "z": "bcaa4e4248dbdbb8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 40,
        "wires": [
            [
                "518b1a0519424a0c"
            ]
        ]
    },
    {
        "id": "518b1a0519424a0c",
        "type": "exec",
        "z": "bcaa4e4248dbdbb8",
        "command": "rpicam-still --encoding png --output ~/Pictures/Camera_PI/test.png --immediate --viewfinder-width 640 --viewfinder-height 480",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 760,
        "y": 100,
        "wires": [
            [],
            [
                "f5ee6a033a789df9"
            ],
            []
        ]
    },
    {
        "id": "3b7aff24fc1ce0b7",
        "type": "ui_button",
        "z": "bcaa4e4248dbdbb8",
        "name": "",
        "group": "763743ce3b9f30a9",
        "order": 0,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Takephoto",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 120,
        "wires": [
            [
                "518b1a0519424a0c"
            ]
        ]
    },
    {
        "id": "f5ee6a033a789df9",
        "type": "function",
        "z": "bcaa4e4248dbdbb8",
        "name": "function 1",
        "func": "// Añade una marca de tiempo para forzar la recarga de la imagen\n// Apuntamos a /test.png, como pediste.\nmsg.url = \"/test.png?t=\" + Date.now();\n//img.src = '/static/test.png?' + new Date().getTime();\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 100,
        "wires": [
            [
                "f182ed60bf5285dc"
            ]
        ]
    },
    {
        "id": "3280eea3639a7899",
        "type": "ui_template",
        "z": "bcaa4e4248dbdbb8",
        "d": true,
        "group": "763743ce3b9f30a9",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<style>\n    #picker-canvas-{{$id}} {\n        width: 100%;\n        height: auto;\n        /* El cursor 'crosshair' (cruz) sigue siendo ideal */\n        cursor: crosshair;\n        background-color: #eee;\n        border: 1px solid #999;\n    }\n    #picker-info-{{$id}} {\n        margin-top: 10px;\n        font-family: monospace;\n        font-size: 16px;\n        display: flex;\n        align-items: center;\n    }\n    #picker-swatch-{{$id}} {\n        display: inline-block;\n        width: 25px;\n        height: 25px;\n        border: 1px solid #000;\n        vertical-align: middle;\n        margin-right: 10px;\n        background-color: #fff;\n    }\n</style>\n\n<canvas id=\"picker-canvas-{{$id}}\"></canvas>\n<div id=\"picker-info-{{$id}}\">\n    <span id=\"picker-swatch-{{$id}}\"></span>\n    <span id=\"picker-rgb-{{$id}}\">(R, G, B)</span>\n</div>\n\n<script>\n(function(scope) {\n    // Referencias a elementos HTML\n    var canvas = document.getElementById('picker-canvas-{{$id}}');\n    var ctx = canvas.getContext('2d');\n    var swatch = document.getElementById('picker-swatch-{{$id}}');\n    var rgbText = document.getElementById('picker-rgb-{{$id}}');\n\n    var img = new Image();\n    img.crossOrigin = \"Anonymous\";\n\n    // Función para cargar/recargar la imagen\n    function updateImage() {\n        // Usamos el \"cache buster\" para forzar la recarga de la imagen\n        img.src = '/test.png?' + new Date().getTime();\n    }\n\n    // Cuando la imagen se carga...\n    img.onload = function() {\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n        ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);\n        \n        // Limpiamos los valores al cargar una nueva foto\n        swatch.style.backgroundColor = \"#fff\";\n        rgbText.textContent = \"(R, G, B)\";\n    };\n    \n    img.onerror = function() {\n        console.error(\"No se pudo cargar la imagen /test.png\");\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.font = \"16px Arial\";\n        ctx.fillStyle = \"red\";\n        ctx.fillText(\"Error al cargar /test.png\", 10, 30);\n    };\n\n    // ======================================================\n    //  CAMBIO PRINCIPAL: Usamos 'click' en lugar de 'mousemove'\n    // ======================================================\n    canvas.addEventListener('click', function(event) {\n        // --- Lógica de Escala (idéntica) ---\n        var rect = canvas.getBoundingClientRect(); \n        var scaleX = canvas.width / rect.width;\n        var scaleY = canvas.height / rect.height;\n        \n        var x = Math.floor(event.offsetX * scaleX);\n        var y = Math.floor(event.offsetY * scaleY);\n        \n        // --- Obtener el Color (idéntico) ---\n        var pixelData = ctx.getImageData(x, y, 1, 1).data;\n        \n        var r = pixelData[0];\n        var g = pixelData[1];\n        var b = pixelData[2];\n        \n        // --- Actualizar la UI (idéntico) ---\n        var rgbString = `rgb(${r}, ${g}, ${b})`;\n        swatch.style.backgroundColor = rgbString;\n        rgbText.textContent = `(${r}, ${g}, ${b})  [${x}, ${y}]`;\n    });\n    \n    // ======================================================\n    //  CAMBIO PRINCIPAL: Se eliminó el evento 'mouseleave'\n    //  (Ya no reseteamos el color cuando el ratón sale)\n    // ======================================================\n\n    // Esta función se ejecuta CADA VEZ que un 'msg' llega al nodo\n    scope.$watch('msg', function(msg) {\n        if (msg) {\n            updateImage();\n        }\n    });\n\n    // Carga la imagen la primera vez\n    setTimeout(updateImage, 100);\n\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1240,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "6208718372351dc0",
        "type": "ui_colour_picker",
        "z": "bcaa4e4248dbdbb8",
        "name": "",
        "label": "",
        "group": "763743ce3b9f30a9",
        "format": "hex",
        "outformat": "string",
        "showSwatch": true,
        "showPicker": false,
        "showValue": false,
        "showHue": false,
        "showAlpha": false,
        "showLightness": true,
        "square": "false",
        "dynOutput": "false",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 1730,
        "y": 160,
        "wires": [
            [
                "37ee4ca1681fca21"
            ]
        ]
    },
    {
        "id": "6bc543bd6209c9fc",
        "type": "ui_template",
        "z": "bcaa4e4248dbdbb8",
        "d": true,
        "group": "763743ce3b9f30a9",
        "name": "",
        "order": 5,
        "width": 0,
        "height": 0,
        "format": "<style>\n    #picker-canvas-{{$id}} { width: 100%; height: auto; cursor: crosshair; ... }\n    #picker-info-{{$id}} { margin-top: 10px; font-family: monospace; ... }\n    #picker-swatch-{{$id}} { display: inline-block; width: 25px; ... }\n</style>\n<canvas id=\"picker-canvas-{{$id}}\"></canvas>\n<div id=\"picker-info-{{$id}}\">\n    <span id=\"picker-swatch-{{$id}}\"></span>\n    <span id=\"picker-rgb-{{$id}}\">(R, G, B)</span>\n</div>\n\n<script>\n(function(scope) {\n    // Referencias a elementos HTML\n    var canvas = document.getElementById('picker-canvas-{{$id}}');\n    var ctx = canvas.getContext('2d');\n    var swatch = document.getElementById('picker-swatch-{{$id}}');\n    var rgbText = document.getElementById('picker-rgb-{{$id}}');\n\n    var img = new Image();\n    img.crossOrigin = \"Anonymous\";\n\n    function updateImage() {\n        img.src = '/test.png?' + new Date().getTime();\n    }\n\n    img.onload = function() {\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n        ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);\n        swatch.style.backgroundColor = \"#fff\";\n        rgbText.textContent = \"(R, G, B)\";\n    };\n    \n    img.onerror = function() {\n        console.error(\"No se pudo cargar la imagen /test.png\");\n        /* ... (código de error idéntico) ... */\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.font = \"16px Arial\"; ctx.fillStyle = \"red\";\n        ctx.fillText(\"Error al cargar /test.png\", 10, 30);\n    };\n\n    canvas.addEventListener('click', function(event) {\n        var rect = canvas.getBoundingClientRect(); \n        var scaleX = canvas.width / rect.width;\n        var scaleY = canvas.height / rect.height;\n        \n        var x = Math.floor(event.offsetX * scaleX);\n        var y = Math.floor(event.offsetY * scaleY);\n        \n        var pixelData = ctx.getImageData(x, y, 1, 1).data;\n        \n        var r = pixelData[0];\n        var g = pixelData[1];\n        var b = pixelData[2];\n        \n        var rgbString = `rgb(${r}, ${g}, ${b})`;\n        swatch.style.backgroundColor = rgbString;\n        rgbText.textContent = `(${r}, ${g}, ${b})  [${x}, ${y}]`;\n\n        // ======================================================\n        //  ¡CAMBIO CLAVE! ENVIAR DATOS AL FLUJO DE NODE-RED\n        // ======================================================\n        \n        // 1. Creamos el string de texto que quieres mostrar\n        var outputString = `(${r}, ${g}, ${b})`;\n\n        // 2. Creamos un nuevo objeto 'msg'\n        var newMsg = {\n            payload: outputString\n        };\n        \n        // 3. Enviamos el mensaje por la salida del nodo\n        scope.send(newMsg);\n        // ======================================================\n    });\n    \n    scope.$watch('msg', function(msg) {\n        if (msg) {\n            updateImage();\n        }\n    });\n\n    setTimeout(updateImage, 100);\n\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1440,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "2611f7884b383611",
        "type": "ui_text",
        "z": "bcaa4e4248dbdbb8",
        "d": true,
        "group": "763743ce3b9f30a9",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "text",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1490,
        "y": 520,
        "wires": []
    },
    {
        "id": "a2d07b74367d9997",
        "type": "ui_button",
        "z": "bcaa4e4248dbdbb8",
        "d": true,
        "name": "",
        "group": "763743ce3b9f30a9",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "button",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"r\":0,\"g\":255,\"b\":0,\"a\":1}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 1250,
        "y": 520,
        "wires": [
            [
                "2611f7884b383611"
            ]
        ]
    },
    {
        "id": "f182ed60bf5285dc",
        "type": "ui_template",
        "z": "bcaa4e4248dbdbb8",
        "group": "763743ce3b9f30a9",
        "name": "",
        "order": 6,
        "width": 0,
        "height": 0,
        "format": "<style>\n    #picker-canvas-{{$id}} { width: 100%; height: auto; cursor: crosshair; }\n    #picker-info-{{$id}} { margin-top: 10px; font-family: monospace; }\n    #picker-swatch-{{$id}} { display: inline-block; width: 25px; height: 25px; border: 1px solid #ccc; vertical-align: middle; margin-right: 5px; }\n</style>\n\n<canvas id=\"picker-canvas-{{$id}}\"></canvas>\n<div id=\"picker-info-{{$id}}\">\n    <span id=\"picker-swatch-{{$id}}\"></span>\n    <span id=\"picker-rgb-{{$id}}\">(R, G, B)</span>\n</div>\n\n<script>\n(function(scope) {\n    // Referencias a elementos HTML\n    var canvas = document.getElementById('picker-canvas-{{$id}}');\n    var ctx = canvas.getContext('2d');\n    var swatch = document.getElementById('picker-swatch-{{$id}}');\n    var rgbText = document.getElementById('picker-rgb-{{$id}}');\n\n    var img = new Image();\n    img.crossOrigin = \"Anonymous\";\n\n    function updateImage() {\n        // Añadimos un timestamp para evitar problemas de caché del navegador\n        img.src = '/test.png?' + new Date().getTime();\n    }\n\n    img.onload = function() {\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n        ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);\n        swatch.style.backgroundColor = \"#fff\";\n        rgbText.textContent = \"(R, G, B)\";\n    };\n    \n    img.onerror = function() {\n        console.error(\"No se pudo cargar la imagen /test.png\");\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.font = \"16px Arial\"; ctx.fillStyle = \"red\";\n        ctx.fillText(\"Error al cargar /test.png\", 10, 30);\n    };\n\n    canvas.addEventListener('click', function(event) {\n        var rect = canvas.getBoundingClientRect(); \n        var scaleX = canvas.width / rect.width;\n        var scaleY = canvas.height / rect.height;\n        \n        var x = Math.floor(event.offsetX * scaleX);\n        var y = Math.floor(event.offsetY * scaleY);\n        \n        var pixelData = ctx.getImageData(x, y, 1, 1).data;\n        \n        var r = pixelData[0];\n        var g = pixelData[1];\n        var b = pixelData[2];\n        \n        // Actualiza la UI del template\n        var rgbString = `rgb(${r}, ${g}, ${b})`;\n        swatch.style.backgroundColor = rgbString;\n        rgbText.textContent = `(${r}, ${g}, ${b})  [${x}, ${y}]`;\n\n        // ======================================================\n        //              *** SECCIÓN CORREGIDA ***\n        // ======================================================\n        \n        // 1. Creamos el OBJETO JSON que requiere el color picker\n        var colorObject = {\n            r: r,\n            g: g,\n            b: b,\n            a: 1  // Añadimos el canal alfa (opacidad) fijado a 1\n        };\n\n        // 2. Creamos un nuevo objeto 'msg' con ese objeto como payload\n        var newMsg = {\n            payload: colorObject\n        };\n         \n        // 3. Enviamos el mensaje por la salida del nodo\n        scope.send(newMsg);\n        // ======================================================\n    });\n    \n    // Se activa cuando un mensaje ENTRA al nodo template\n    scope.$watch('msg', function(msg) {\n        if (msg) {\n            // Asume que cualquier mensaje entrante (del botón)\n            // debe refrescar la imagen.\n            updateImage();\n        }\n    });\n\n    // Carga la imagen una vez cuando el dashboard se inicia\n    setTimeout(updateImage, 100);\n\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1500,
        "y": 100,
        "wires": [
            [
                "6208718372351dc0",
                "f42d716a12403ac9"
            ]
        ]
    },
    {
        "id": "f42d716a12403ac9",
        "type": "ui_text",
        "z": "bcaa4e4248dbdbb8",
        "d": true,
        "group": "763743ce3b9f30a9",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "text",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1670,
        "y": 60,
        "wires": []
    },
    {
        "id": "37ee4ca1681fca21",
        "type": "function",
        "z": "bcaa4e4248dbdbb8",
        "name": "function 2",
        "func": "/*\n * Se requiere que imprima RGB | CMYK\n * Espera msg.payload como string tipo \"#RRGGBB\"\n */\n\n// 1. OBTENER Y VALIDAR HEX\nlet hex = String(msg.payload || \"\").trim();\nif (!/^#?[0-9a-fA-F]{6}$/.test(hex)) {\n  node.warn(\"Formato HEX inválido: \" + hex);\n  return null;\n}\nif (hex[0] === '#') hex = hex.slice(1);\n\n// 2. CONVERTIR HEX A RGB (0-255)\nconst r = parseInt(hex.slice(0, 2), 16);\nconst g = parseInt(hex.slice(2, 4), 16);\nconst b = parseInt(hex.slice(4, 6), 16);\n\n// 3. CONVERTIR RGB A CMYK (0-100)\n\n// Normalizar RGB (0-1)\nconst rN = r / 255;\nconst gN = g / 255;\nconst bN = b / 255;\n\n// Calcular K (Key/Black)\nconst k = 1 - Math.max(rN, gN, bN);\n\n// Manejar división por cero (si K=1, el color es negro puro)\nlet c, m, y;\nif (k === 1) {\n  c = 0;\n  m = 0;\n  y = 0;\n} else {\n  // Calcular C, M, Y\n  c = (1 - rN - k) / (1 - k);\n  m = (1 - gN - k) / (1 - k);\n  y = (1 - bN - k) / (1 - k);\n}\n\n// Convertir a porcentaje (0-100) y redondear\nconst cP = Math.round(c * 100);\nconst mP = Math.round(m * 100);\nconst yP = Math.round(y * 100);\nconst kP = Math.round(k * 100);\n\n// 4. FORMATEAR SALIDAS\n\n// Mostramos RGB y CMYK en la UI\nmsg.payload = `RGB: ${r}, ${g}, ${b} | CMYK: ${cP}%, ${mP}%, ${yP}%, ${kP}%`;\n\n// Guardamos objetos para usos futuros\nmsg.rgb = { r, g, b };\nmsg.cmyk = { c: cP, m: mP, y: yP, k: kP };\n\n// Para archivo: agregamos timestamp y CSV simple (con RGB y CMYK)\nconst ts = new Date().toISOString();\nmsg.filePayload = `${ts};${r};${g};${b};${cP};${mP};${yP};${kP}`;\n\nreturn [msg];",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1920,
        "y": 160,
        "wires": [
            [
                "d9302e9dab9df139",
                "ab4d1734bfd02ebe"
            ]
        ]
    },
    {
        "id": "d9302e9dab9df139",
        "type": "ui_text",
        "z": "bcaa4e4248dbdbb8",
        "group": "763743ce3b9f30a9",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 2110,
        "y": 160,
        "wires": []
    },
    {
        "id": "ab4d1734bfd02ebe",
        "type": "file",
        "z": "bcaa4e4248dbdbb8",
        "name": "",
        "filename": "/home/pi/Pictures/Camera_PI/pp.txt",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 2220,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "930bfe876b481586",
        "type": "ui_template",
        "z": "f01b2326bc102ff4",
        "group": "64236f01351959f5",
        "name": "",
        "order": 4,
        "width": "0",
        "height": "0",
        "format": "<div style=\"text-align:center;\">\n  <h3>Selecciona un punto de la imagen</h3>\n  <canvas id=\"canvas\" width=\"640\" height=\"480\" style=\"border:1px solid #000;\"></canvas>\n  <p id=\"colorInfo\">Haz clic en un punto de la imagen</p>\n</div>\n\n<script>\n(function(scope) {\n    const canvas = document.getElementById(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    const colorInfo = document.getElementById(\"colorInfo\");\n    let img = new Image();\n\n    // Se ejecuta cada vez que llega un nuevo mensaje MQTT\n    scope.$watch('msg.payload', function(data) {\n        if (!data) return;\n\n        // Dibujar la nueva imagen\n        img = new Image();\n        img.onload = function() {\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n        };\n        img.src = data;  // base64 recibido desde MQTT\n    });\n\n    // Detectar clic y obtener color RGB y HEX\n    canvas.addEventListener(\"click\", function(event) {\n        const rect = canvas.getBoundingClientRect();\n        const x = event.clientX - rect.left;\n        const y = event.clientY - rect.top;\n\n        const pixel = ctx.getImageData(x, y, 1, 1).data;\n        const rgb = `rgb(${pixel[0]}, ${pixel[1]}, ${pixel[2]})`;\n        const hex = \"#\" + ((1 << 24) + (pixel[0] << 16) + (pixel[1] << 8) + pixel[2]).toString(16).slice(1).toUpperCase();\n\n        colorInfo.innerText = `Coordenadas: (${Math.round(x)},${Math.round(y)}) - ${rgb} - ${hex}`;\n        \n        // Enviar el color a Node-RED\n        scope.send({ payload: { x: x, y: y, rgb: rgb, hex: hex } });\n    });\n})(scope);\n</script>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 380,
        "y": 140,
        "wires": [
            [
                "f5aa989c6c768b94"
            ]
        ]
    },
    {
        "id": "0fe28d7f521a914e",
        "type": "debug",
        "z": "f01b2326bc102ff4",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 80,
        "wires": []
    },
    {
        "id": "f5aa989c6c768b94",
        "type": "function",
        "z": "f01b2326bc102ff4",
        "name": "Procesar_color",
        "func": "// espera msg.payload = {x, y, rgb:[r,g,b], hex:\"#RRGGBB\"}\nlet info = msg.payload || {};\nlet hex = info.hex || \"#000000\";\nlet rgb = info.rgb || [0,0,0];\n\n// Prepara dos mensajes:\n// msg1 para el color picker (payload = hex string)\n// msg2 para debug o visualización (objeto completo)\nlet msgColor = { payload: hex };         // el ui_colour espera una string \"#RRGGBB\"\nlet msgDebug = { payload: { hex: hex, rgb: rgb, coords: {x: info.x, y: info.y} } };\n\n// Envío en 2 salidas: salida 1 -> color picker, salida 2 -> debug/tabla\nreturn [msgColor, msgDebug];\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 140,
        "wires": [
            [
                "1f359d6384dc820d",
                "0fe28d7f521a914e",
                "a942e0138ffbd2d4"
            ]
        ]
    },
    {
        "id": "1f359d6384dc820d",
        "type": "mqtt out",
        "z": "f01b2326bc102ff4",
        "name": "",
        "topic": "esp/out",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "89b5767d2d6aab10",
        "x": 860,
        "y": 140,
        "wires": []
    },
    {
        "id": "a942e0138ffbd2d4",
        "type": "ui_colour_picker",
        "z": "f01b2326bc102ff4",
        "name": "",
        "label": "",
        "group": "64236f01351959f5",
        "format": "hex",
        "outformat": "string",
        "showSwatch": true,
        "showPicker": false,
        "showValue": false,
        "showHue": false,
        "showAlpha": false,
        "showLightness": true,
        "square": "false",
        "dynOutput": "false",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 770,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "bde4ccaf79960ab1",
        "type": "debug",
        "z": "f01b2326bc102ff4",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 380,
        "y": 200,
        "wires": []
    },
    {
        "id": "b0964f897f969a9b",
        "type": "mqtt in",
        "z": "f01b2326bc102ff4",
        "name": "",
        "topic": "camara/pi",
        "qos": "0",
        "datatype": "auto-detect",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 140,
        "wires": [
            [
                "930bfe876b481586",
                "bde4ccaf79960ab1"
            ]
        ]
    },
    {
        "id": "22350da20c3b7ee3",
        "type": "ui_button",
        "z": "f01b2326bc102ff4",
        "name": "",
        "group": "64236f01351959f5",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Tomar foto",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "capturar",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 320,
        "wires": [
            [
                "618420b72fb802b5",
                "67f4de830f2d8eeb",
                "b5697d17c27d9f62"
            ]
        ]
    },
    {
        "id": "618420b72fb802b5",
        "type": "mqtt out",
        "z": "f01b2326bc102ff4",
        "name": "",
        "topic": "camara/captura",
        "qos": "0",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "89b5767d2d6aab10",
        "x": 760,
        "y": 300,
        "wires": []
    },
    {
        "id": "67f4de830f2d8eeb",
        "type": "debug",
        "z": "f01b2326bc102ff4",
        "name": "debug 5",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 740,
        "y": 360,
        "wires": []
    },
    {
        "id": "b5697d17c27d9f62",
        "type": "json",
        "z": "f01b2326bc102ff4",
        "name": "",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 750,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "d6e4f32b9f77182c",
        "type": "mqtt in",
        "z": "1142a758c3b277ef",
        "name": "",
        "topic": "sensor/peso",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "180082cf2286b03f",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 230,
        "y": 180,
        "wires": [
            [
                "09e6fac52a131186",
                "15a498d348548e2c"
            ]
        ]
    },
    {
        "id": "09e6fac52a131186",
        "type": "ui_gauge",
        "z": "1142a758c3b277ef",
        "name": "",
        "group": "6511f5347db4bf39",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "gauge",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "3000",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 470,
        "y": 240,
        "wires": []
    },
    {
        "id": "15a498d348548e2c",
        "type": "ui_chart",
        "z": "1142a758c3b277ef",
        "name": "",
        "group": "6511f5347db4bf39",
        "order": 0,
        "width": 0,
        "height": 0,
        "label": "Histograma",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "3000",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 450,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "3b234cbb9b37d194",
        "type": "mqtt in",
        "z": "934d5fc036780bc6",
        "name": "bascula/peso",
        "topic": "bascula/peso",
        "qos": "2",
        "datatype": "auto",
        "broker": "f5bb53dfb5cccc7f",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 190,
        "y": 140,
        "wires": [
            [
                "7e8368be77117e26",
                "e9d43c3f77ead580"
            ]
        ]
    },
    {
        "id": "7e8368be77117e26",
        "type": "ui_gauge",
        "z": "934d5fc036780bc6",
        "name": "Peso Actual",
        "group": "g1h2j3k4.l5m6n7",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Peso",
        "label": "kg",
        "format": "{{value}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 510,
        "y": 120,
        "wires": []
    },
    {
        "id": "b6bfda8acaf384e8",
        "type": "ui_button",
        "z": "934d5fc036780bc6",
        "name": "",
        "group": "g1h2j3k4.l5m6n7",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARAR BÁSCULA",
        "tooltip": "Pone la báscula a cero",
        "color": "",
        "bgcolor": "#004466",
        "icon": "",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando",
        "topicType": "str",
        "x": 830,
        "y": 120,
        "wires": [
            [
                "1d66b10f95a4c052"
            ]
        ]
    },
    {
        "id": "1d66b10f95a4c052",
        "type": "mqtt out",
        "z": "934d5fc036780bc6",
        "name": "Enviar Comando a Báscula",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "f5bb53dfb5cccc7f",
        "x": 1120,
        "y": 120,
        "wires": []
    },
    {
        "id": "e9d43c3f77ead580",
        "type": "debug",
        "z": "934d5fc036780bc6",
        "name": "Debug Peso",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 180,
        "wires": []
    },
    {
        "id": "6d953d61.16432c",
        "type": "ui_button",
        "z": "934d5fc036780bc6",
        "name": "TARA 1",
        "group": "c13d8d6.b38c26",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 1",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_1",
        "topicType": "str",
        "x": 670,
        "y": 880,
        "wires": [
            [
                "460061e8.59b66"
            ]
        ]
    },
    {
        "id": "460061e8.59b66",
        "type": "mqtt out",
        "z": "934d5fc036780bc6",
        "name": "Comando MQTT",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "broker": "e2401f95.5d9e5",
        "x": 1030,
        "y": 960,
        "wires": []
    },
    {
        "id": "50e93b12.c25fa",
        "type": "ui_button",
        "z": "934d5fc036780bc6",
        "name": "TARA 2",
        "group": "c13d8d6.b38c26",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 2",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_2",
        "topicType": "str",
        "x": 670,
        "y": 920,
        "wires": [
            [
                "460061e8.59b66"
            ]
        ]
    },
    {
        "id": "18f918e9.2e8d35",
        "type": "ui_button",
        "z": "934d5fc036780bc6",
        "name": "TARA 3",
        "group": "c13d8d6.b38c26",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 3",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_3",
        "topicType": "str",
        "x": 670,
        "y": 960,
        "wires": [
            [
                "460061e8.59b66"
            ]
        ]
    },
    {
        "id": "c768a183.1b4728",
        "type": "ui_button",
        "z": "934d5fc036780bc6",
        "name": "TARA 4",
        "group": "c13d8d6.b38c26",
        "order": 9,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 4",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_4",
        "topicType": "str",
        "x": 670,
        "y": 1000,
        "wires": [
            [
                "460061e8.59b66"
            ]
        ]
    },
    {
        "id": "90d1f768.4b2078",
        "type": "ui_button",
        "z": "934d5fc036780bc6",
        "name": "TARA 5",
        "group": "c13d8d6.b38c26",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 5",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_5",
        "topicType": "str",
        "x": 670,
        "y": 1040,
        "wires": [
            [
                "460061e8.59b66"
            ]
        ]
    },
    {
        "id": "f9c39aa0e836f1f8",
        "type": "mqtt in",
        "z": "cdf677c5e1a7be6e",
        "name": "Báscula 1 Peso",
        "topic": "bascula/peso/bascula_1",
        "qos": "0",
        "datatype": "utf8",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 120,
        "y": 120,
        "wires": [
            [
                "5dd59240ca8ed1a2",
                "c1f495449141b866"
            ]
        ]
    },
    {
        "id": "c1f495449141b866",
        "type": "ui_gauge",
        "z": "cdf677c5e1a7be6e",
        "name": "Peso Báscula 1",
        "group": "c13d8d6.b38c26",
        "order": 1,
        "width": "0",
        "height": "0",
        "gtype": "wave",
        "title": "Báscula 1 (g)",
        "label": "g",
        "format": "{{value | number:2}}",
        "min": 0,
        "max": "1000",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "5",
        "seg2": "8",
        "diff": false,
        "className": "",
        "x": 500,
        "y": 140,
        "wires": []
    },
    {
        "id": "5dd59240ca8ed1a2",
        "type": "debug",
        "z": "cdf677c5e1a7be6e",
        "name": "Debug 1",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 310,
        "y": 80,
        "wires": []
    },
    {
        "id": "09a55fc94fe3e369",
        "type": "mqtt in",
        "z": "cdf677c5e1a7be6e",
        "name": "Báscula 2 Peso",
        "topic": "bascula/peso/bascula_2",
        "qos": "0",
        "datatype": "utf8",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 120,
        "y": 200,
        "wires": [
            [
                "70de58e9efb214d3",
                "0f14cb37220bb28c"
            ]
        ]
    },
    {
        "id": "0f14cb37220bb28c",
        "type": "ui_gauge",
        "z": "cdf677c5e1a7be6e",
        "name": "Peso Báscula 2",
        "group": "c13d8d6.b38c26",
        "order": 2,
        "width": "0",
        "height": "0",
        "gtype": "wave",
        "title": "Báscula 2 (kg)",
        "label": "kg",
        "format": "{{value | number:2}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "5",
        "seg2": "8",
        "diff": false,
        "className": "",
        "x": 510,
        "y": 200,
        "wires": []
    },
    {
        "id": "70de58e9efb214d3",
        "type": "debug",
        "z": "cdf677c5e1a7be6e",
        "name": "Debug 2",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 320,
        "y": 260,
        "wires": []
    },
    {
        "id": "536d74c22c5ca695",
        "type": "mqtt in",
        "z": "cdf677c5e1a7be6e",
        "name": "Báscula 3 Peso",
        "topic": "bascula/peso/bascula_3",
        "qos": "0",
        "datatype": "utf8",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 320,
        "wires": [
            [
                "02760ecf14fb9089",
                "e5089c2131cf11b0"
            ]
        ]
    },
    {
        "id": "e5089c2131cf11b0",
        "type": "ui_gauge",
        "z": "cdf677c5e1a7be6e",
        "name": "Peso Báscula 3",
        "group": "c13d8d6.b38c26",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Báscula 3 (kg)",
        "label": "kg",
        "format": "{{value | number:2}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "5",
        "seg2": "8",
        "diff": false,
        "className": "",
        "x": 500,
        "y": 320,
        "wires": []
    },
    {
        "id": "02760ecf14fb9089",
        "type": "debug",
        "z": "cdf677c5e1a7be6e",
        "name": "Debug 3",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 310,
        "y": 380,
        "wires": []
    },
    {
        "id": "a7709893a72bf0b4",
        "type": "mqtt in",
        "z": "cdf677c5e1a7be6e",
        "name": "Báscula 4 Peso",
        "topic": "bascula/peso/bascula_4",
        "qos": "0",
        "datatype": "utf8",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 440,
        "wires": [
            [
                "2f5c191bc80bb92d",
                "038c842eee6318dc"
            ]
        ]
    },
    {
        "id": "038c842eee6318dc",
        "type": "ui_gauge",
        "z": "cdf677c5e1a7be6e",
        "name": "Peso Báscula 4",
        "group": "c13d8d6.b38c26",
        "order": 4,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Báscula 4 (kg)",
        "label": "kg",
        "format": "{{value | number:2}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "5",
        "seg2": "8",
        "diff": false,
        "className": "",
        "x": 500,
        "y": 440,
        "wires": []
    },
    {
        "id": "2f5c191bc80bb92d",
        "type": "debug",
        "z": "cdf677c5e1a7be6e",
        "name": "Debug 4",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 310,
        "y": 500,
        "wires": []
    },
    {
        "id": "3ffeac850de4c53f",
        "type": "mqtt in",
        "z": "cdf677c5e1a7be6e",
        "name": "Báscula 5 Peso",
        "topic": "bascula/peso/bascula_5",
        "qos": "0",
        "datatype": "utf8",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 560,
        "wires": [
            [
                "327a9df47607630a",
                "d0ec759da936513d"
            ]
        ]
    },
    {
        "id": "d0ec759da936513d",
        "type": "ui_gauge",
        "z": "cdf677c5e1a7be6e",
        "name": "Peso Báscula 5",
        "group": "c13d8d6.b38c26",
        "order": 5,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Báscula 5 (kg)",
        "label": "kg",
        "format": "{{value | number:2}}",
        "min": 0,
        "max": "10",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "5",
        "seg2": "8",
        "diff": false,
        "className": "",
        "x": 500,
        "y": 560,
        "wires": []
    },
    {
        "id": "327a9df47607630a",
        "type": "debug",
        "z": "cdf677c5e1a7be6e",
        "name": "Debug 5",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 310,
        "y": 620,
        "wires": []
    },
    {
        "id": "aee2c2f5600d96ce",
        "type": "ui_button",
        "z": "cdf677c5e1a7be6e",
        "name": "TARA 1",
        "group": "c13d8d6.b38c26",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 1",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "className": "",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_1",
        "topicType": "str",
        "x": 120,
        "y": 700,
        "wires": [
            [
                "f4711687726d4bb6"
            ]
        ]
    },
    {
        "id": "f4711687726d4bb6",
        "type": "mqtt out",
        "z": "cdf677c5e1a7be6e",
        "name": "Comando MQTT",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "89b5767d2d6aab10",
        "x": 690,
        "y": 780,
        "wires": []
    },
    {
        "id": "3775b1e212f740ef",
        "type": "ui_button",
        "z": "cdf677c5e1a7be6e",
        "name": "TARA 2",
        "group": "c13d8d6.b38c26",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 2",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_2",
        "topicType": "str",
        "x": 120,
        "y": 740,
        "wires": [
            [
                "f4711687726d4bb6"
            ]
        ]
    },
    {
        "id": "11e28c9e464b67c0",
        "type": "ui_button",
        "z": "cdf677c5e1a7be6e",
        "name": "TARA 3",
        "group": "c13d8d6.b38c26",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 3",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_3",
        "topicType": "str",
        "x": 120,
        "y": 780,
        "wires": [
            [
                "f4711687726d4bb6"
            ]
        ]
    },
    {
        "id": "e48c93437e3bedbf",
        "type": "ui_button",
        "z": "cdf677c5e1a7be6e",
        "name": "TARA 4",
        "group": "c13d8d6.b38c26",
        "order": 9,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 4",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_4",
        "topicType": "str",
        "x": 120,
        "y": 820,
        "wires": [
            [
                "f4711687726d4bb6"
            ]
        ]
    },
    {
        "id": "61a4b8b6d1af1ac5",
        "type": "ui_button",
        "z": "cdf677c5e1a7be6e",
        "name": "TARA 5",
        "group": "c13d8d6.b38c26",
        "order": 10,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "TARA Báscula 5",
        "tooltip": "",
        "color": "",
        "bgcolor": "#ff7f7f",
        "icon": "fa-undo",
        "payload": "TARA",
        "payloadType": "str",
        "topic": "bascula/comando/bascula_5",
        "topicType": "str",
        "x": 120,
        "y": 860,
        "wires": [
            [
                "f4711687726d4bb6"
            ]
        ]
    },
    {
        "id": "b41afdb06d934104",
        "type": "mqtt in",
        "z": "dc25c51e2f8bdb1b",
        "name": "MQTT Activación Negra",
        "topic": "bomba/negra/activacion",
        "qos": "0",
        "datatype": "auto",
        "broker": "138c9e1c6a6f1c8e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 60,
        "wires": [
            [
                "112d74d168ce88d1"
            ]
        ]
    },
    {
        "id": "5a26b121ceb988f1",
        "type": "mqtt in",
        "z": "dc25c51e2f8bdb1b",
        "name": "MQTT Galga Negra",
        "topic": "bomba/negra/galga",
        "qos": "0",
        "datatype": "auto",
        "broker": "138c9e1c6a6f1c8e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 100,
        "wires": [
            [
                "112d74d168ce88d1"
            ]
        ]
    },
    {
        "id": "22bf6c7b3e352735",
        "type": "mqtt in",
        "z": "dc25c51e2f8bdb1b",
        "name": "MQTT Temperatura Negra",
        "topic": "bomba/negra/temperatura",
        "qos": "0",
        "datatype": "auto",
        "broker": "138c9e1c6a6f1c8e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 260,
        "wires": [
            [
                "112d74d168ce88d1"
            ]
        ]
    },
    {
        "id": "91580aa9393372f2",
        "type": "ui_switch",
        "z": "dc25c51e2f8bdb1b",
        "name": "Manual Activación",
        "label": "Activación",
        "tooltip": "",
        "group": "34dc4380d806bb6b",
        "order": 1,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/negra/activacion",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 170,
        "y": 20,
        "wires": [
            [
                "112d74d168ce88d1"
            ]
        ]
    },
    {
        "id": "fd7df25aa257d263",
        "type": "ui_switch",
        "z": "dc25c51e2f8bdb1b",
        "name": "Manual Galga",
        "label": "Galga",
        "tooltip": "",
        "group": "34dc4380d806bb6b",
        "order": 2,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/negra/galga",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 160,
        "y": 160,
        "wires": [
            [
                "112d74d168ce88d1"
            ]
        ]
    },
    {
        "id": "09913424657b2f14",
        "type": "ui_switch",
        "z": "dc25c51e2f8bdb1b",
        "name": "Manual Temperatura",
        "label": "Temperatura",
        "tooltip": "",
        "group": "34dc4380d806bb6b",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/negra/temperatura",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 160,
        "y": 200,
        "wires": [
            [
                "112d74d168ce88d1"
            ]
        ]
    },
    {
        "id": "112d74d168ce88d1",
        "type": "function",
        "z": "dc25c51e2f8bdb1b",
        "name": "Lógica Bomba Negra",
        "func": "// Variables globales para entradas\nlet act = flow.get('negra_act') || false;\nlet galga = flow.get('negra_galga') || false;\nlet temp = flow.get('negra_temp') || false;\n\n// Detectar cuál entrada cambió\nact = msg.topic.includes('activacion') ? (msg.payload == true || msg.payload == 'true') : act;\ngalga = msg.topic.includes('galga') ? (msg.payload == true || msg.payload == 'true') : galga;\ntemp = msg.topic.includes('temperatura') ? (msg.payload == true || msg.payload == 'true') : temp;\n\nflow.set('negra_act', act);\nflow.set('negra_galga', galga);\nflow.set('negra_temp', temp);\n\n// Verificar si todas son true\nlet auto_on = act && galga && temp;\nflow.set('negra_auto_on', auto_on);\n\n// Publicar a LEDS\nnode.send([{payload: act}, {payload: galga}, {payload: temp}, {payload: auto_on}]);\nreturn null;",
        "outputs": 4,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 130,
        "wires": [
            [
                "f6334af7e2960a30"
            ],
            [
                "5a300f98c8c5b473"
            ],
            [
                "e428100b5594ddb8"
            ],
            [
                "bf88e8f6feac1f88"
            ]
        ]
    },
    {
        "id": "0aaab5de3d6e896f",
        "type": "ui_switch",
        "z": "dc25c51e2f8bdb1b",
        "name": "Encendido Manual",
        "label": "Manual",
        "tooltip": "",
        "group": "34dc4380d806bb6b",
        "order": 7,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/negra/manual",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 190,
        "y": 360,
        "wires": [
            [
                "bf88e8f6feac1f88"
            ]
        ]
    },
    {
        "id": "bf88e8f6feac1f88",
        "type": "function",
        "z": "dc25c51e2f8bdb1b",
        "name": "Control Final Bomba Negra",
        "func": "let auto_on = flow.get('negra_auto_on') || false;\nlet manual = (msg.payload === true || msg.payload === 'true');\n\nlet estado = auto_on || manual;\nflow.set('negra_estado', estado);\n\nreturn [{payload: estado}, {payload: estado}];",
        "outputs": 2,
        "noerr": 0,
        "x": 470,
        "y": 260,
        "wires": [
            [
                "bb7f834ac82f6ee5"
            ],
            [
                "19b359b8902d87e8"
            ]
        ]
    },
    {
        "id": "19b359b8902d87e8",
        "type": "mqtt out",
        "z": "dc25c51e2f8bdb1b",
        "name": "MQTT Estado Negra",
        "topic": "bomba/negra/estado",
        "qos": "0",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "138c9e1c6a6f1c8e",
        "x": 710,
        "y": 310,
        "wires": []
    },
    {
        "id": "f6334af7e2960a30",
        "type": "ui_led",
        "z": "dc25c51e2f8bdb1b",
        "order": 4,
        "group": "ui_negra",
        "width": "0",
        "height": "0",
        "label": "Activación",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 830,
        "y": 80,
        "wires": []
    },
    {
        "id": "5a300f98c8c5b473",
        "type": "ui_led",
        "z": "dc25c51e2f8bdb1b",
        "order": 5,
        "group": "ui_negra",
        "width": "0",
        "height": "0",
        "label": "Galga",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 840,
        "y": 120,
        "wires": []
    },
    {
        "id": "e428100b5594ddb8",
        "type": "ui_led",
        "z": "dc25c51e2f8bdb1b",
        "order": 6,
        "group": "ui_negra",
        "width": "0",
        "height": "0",
        "label": "Temperatura",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 840,
        "y": 180,
        "wires": []
    },
    {
        "id": "bb7f834ac82f6ee5",
        "type": "ui_led",
        "z": "dc25c51e2f8bdb1b",
        "order": 8,
        "group": "ui_negra",
        "width": "0",
        "height": "0",
        "label": "Bomba Negra",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 710,
        "y": 260,
        "wires": []
    },
    {
        "id": "f929868dde020efb",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Activación Negra",
        "topic": "bomba/negra/activacion",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 80,
        "wires": [
            [
                "e6d25210053c7622"
            ]
        ]
    },
    {
        "id": "bdb73ba14b62fbea",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Galga Negra",
        "topic": "bomba/negra/galga",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 130,
        "wires": [
            [
                "e6d25210053c7622"
            ]
        ]
    },
    {
        "id": "4f6e45a1b35311fc",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Temperatura Negra",
        "topic": "bomba/negra/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 180,
        "wires": [
            [
                "e6d25210053c7622"
            ]
        ]
    },
    {
        "id": "e6d25210053c7622",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Lógica Bomba Negra",
        "func": "// Variables globales para entradas\nlet act = flow.get('negra_act') || false;\nlet galga = flow.get('negra_galga') || false;\nlet temp = flow.get('negra_temp') || false;\n\n// Detectar cuál entrada cambió\nauto = msg.topic.includes('activacion') ? (msg.payload == true || msg.payload == 'true') : act;\ngalga = msg.topic.includes('galga') ? (msg.payload == true || msg.payload == 'true') : galga;\ntemp = msg.topic.includes('temperatura') ? (msg.payload == true || msg.payload == 'true') : temp;\n\nflow.set('negra_act', act);\nflow.set('negra_galga', galga);\nflow.set('negra_temp', temp);\n\n// Verificar si todas son true\nlet auto_on = act && galga && temp;\nflow.set('negra_auto_on', auto_on);\n\n// Publicar a LEDS\nnode.send([{payload: act}, {payload: galga}, {payload: temp}, {payload: auto_on}]);\nreturn null;",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 130,
        "wires": [
            [
                "6b2fef526e897520"
            ],
            [
                "2cec0def082ef781"
            ],
            [
                "e04f67897d41a3e4"
            ],
            [
                "78175ecbb837c6a5"
            ]
        ]
    },
    {
        "id": "6b2fef526e897520",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 1,
        "group": "0d7198bbbc68d529",
        "width": "0",
        "height": "0",
        "label": "Activación",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 720,
        "y": 80,
        "wires": []
    },
    {
        "id": "2cec0def082ef781",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 2,
        "group": "0d7198bbbc68d529",
        "width": "0",
        "height": "0",
        "label": "Galga",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 710,
        "y": 130,
        "wires": []
    },
    {
        "id": "e04f67897d41a3e4",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 3,
        "group": "0d7198bbbc68d529",
        "width": "0",
        "height": "0",
        "label": "Temperatura",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 720,
        "y": 180,
        "wires": []
    },
    {
        "id": "94f7451e6fb47165",
        "type": "ui_switch",
        "z": "8167fc72ca67c031",
        "name": "Encendido Manual",
        "label": "Manual",
        "tooltip": "",
        "group": "0d7198bbbc68d529",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/negra/manual",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 190,
        "y": 260,
        "wires": [
            [
                "78175ecbb837c6a5"
            ]
        ]
    },
    {
        "id": "78175ecbb837c6a5",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Control Final Bomba Negra",
        "func": "let auto_on = flow.get('negra_auto_on') || false;\nlet manual = (msg.payload === true || msg.payload === 'true');\n\nlet estado = auto_on || manual;\nflow.set('negra_estado', estado);\n\nreturn [{payload: estado}, {payload: estado}];",
        "outputs": 2,
        "noerr": 0,
        "x": 470,
        "y": 260,
        "wires": [
            [
                "eeb3c1eb05b4f4d8"
            ],
            [
                "ec0851d3662f4779"
            ]
        ]
    },
    {
        "id": "eeb3c1eb05b4f4d8",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 5,
        "group": "0d7198bbbc68d529",
        "width": "0",
        "height": "0",
        "label": "Bomba Negra",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 710,
        "y": 260,
        "wires": []
    },
    {
        "id": "ec0851d3662f4779",
        "type": "mqtt out",
        "z": "8167fc72ca67c031",
        "name": "MQTT Estado Negra",
        "topic": "bomba/negra/estado",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "",
        "x": 710,
        "y": 310,
        "wires": []
    },
    {
        "id": "6206bc96b43cbf9d",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Activación Blanca",
        "topic": "bomba/blanca/activacion",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 950,
        "y": 80,
        "wires": [
            [
                "bb229950ddb2463a"
            ]
        ]
    },
    {
        "id": "f3101524c77be048",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Galga Blanca",
        "topic": "bomba/blanca/galga",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 950,
        "y": 130,
        "wires": [
            [
                "bb229950ddb2463a"
            ]
        ]
    },
    {
        "id": "c6945a2f2c670cdb",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Temperatura Blanca",
        "topic": "bomba/blanca/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 960,
        "y": 180,
        "wires": [
            [
                "bb229950ddb2463a"
            ]
        ]
    },
    {
        "id": "bb229950ddb2463a",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Lógica Bomba Blanca",
        "func": "// Variables globales para entradas\nlet act = flow.get('blanca_act') || false;\nlet galga = flow.get('blanca_galga') || false;\nlet temp = flow.get('blanca_temp') || false;\n\n// Detectar cuál entrada cambió\nact = msg.topic.includes('activacion') ? (msg.payload == true || msg.payload == 'true') : act;\ngalga = msg.topic.includes('galga') ? (msg.payload == true || msg.payload == 'true') : galga;\ntemp = msg.topic.includes('temperatura') ? (msg.payload == true || msg.payload == 'true') : temp;\n\nflow.set('blanca_act', act);\nflow.set('blanca_galga', galga);\nflow.set('blanca_temp', temp);\n\n// Verificar si todas son true\nlet auto_on = act && galga && temp;\nflow.set('blanca_auto_on', auto_on);\n\n// Publicar a LEDS\nnode.send([{payload: act}, {payload: galga}, {payload: temp}, {payload: auto_on}]);\nreturn null;",
        "outputs": 4,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 130,
        "wires": [
            [
                "fd3704a558221c4e"
            ],
            [
                "aed637924fd6a24b"
            ],
            [
                "c006c6be971cfd82"
            ],
            [
                "6876ef13932dff01"
            ]
        ]
    },
    {
        "id": "fd3704a558221c4e",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 1,
        "group": "ui_blanca",
        "width": "0",
        "height": "0",
        "label": "Activación",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1490,
        "y": 80,
        "wires": []
    },
    {
        "id": "aed637924fd6a24b",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 2,
        "group": "ui_blanca",
        "width": "0",
        "height": "0",
        "label": "Galga",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1480,
        "y": 130,
        "wires": []
    },
    {
        "id": "c006c6be971cfd82",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 3,
        "group": "ui_blanca",
        "width": "0",
        "height": "0",
        "label": "Temperatura",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1490,
        "y": 180,
        "wires": []
    },
    {
        "id": "3ce4d3741a03497b",
        "type": "ui_switch",
        "z": "8167fc72ca67c031",
        "name": "Encendido Manual",
        "label": "Manual",
        "tooltip": "",
        "group": "ui_blanca",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/blanca/manual",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 960,
        "y": 260,
        "wires": [
            [
                "6876ef13932dff01"
            ]
        ]
    },
    {
        "id": "6876ef13932dff01",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Control Final Bomba Blanca",
        "func": "let auto_on = flow.get('blanca_auto_on') || false;\nlet manual = (msg.payload === true || msg.payload === 'true');\n\nlet estado = auto_on || manual;\nflow.set('blanca_estado', estado);\n\nreturn [{payload: estado}, {payload: estado}];",
        "outputs": 2,
        "noerr": 0,
        "x": 1240,
        "y": 260,
        "wires": [
            [
                "33c2f4ccf34301c3"
            ],
            [
                "1e4057211bc740e0"
            ]
        ]
    },
    {
        "id": "33c2f4ccf34301c3",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 5,
        "group": "ui_blanca",
        "width": "0",
        "height": "0",
        "label": "Bomba Blanca",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1480,
        "y": 260,
        "wires": []
    },
    {
        "id": "1e4057211bc740e0",
        "type": "mqtt out",
        "z": "8167fc72ca67c031",
        "name": "MQTT Estado Blanca",
        "topic": "bomba/blanca/estado",
        "qos": "2",
        "retain": "false",
        "broker": "",
        "x": 1480,
        "y": 310,
        "wires": []
    },
    {
        "id": "9dfb85f7d52cfe31",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Activación Azul",
        "topic": "bomba/azul/activacion",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 200,
        "y": 380,
        "wires": [
            [
                "87b8de0960471881"
            ]
        ]
    },
    {
        "id": "551a2784546f0d7b",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Galga Azul",
        "topic": "bomba/azul/galga",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 200,
        "y": 430,
        "wires": [
            [
                "87b8de0960471881"
            ]
        ]
    },
    {
        "id": "e3e85980970f8343",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Temperatura Azul",
        "topic": "bomba/azul/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 210,
        "y": 480,
        "wires": [
            [
                "87b8de0960471881"
            ]
        ]
    },
    {
        "id": "87b8de0960471881",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Lógica Bomba Azul",
        "func": "// Variables globales para entradas\nlet act = flow.get('azul_act') || false;\nlet galga = flow.get('azul_galga') || false;\nlet temp = flow.get('azul_temp') || false;\n\n// Detectar cuál entrada cambió\nact = msg.topic.includes('activacion') ? (msg.payload == true || msg.payload == 'true') : act;\ngalga = msg.topic.includes('galga') ? (msg.payload == true || msg.payload == 'true') : galga;\ntemp = msg.topic.includes('temperatura') ? (msg.payload == true || msg.payload == 'true') : temp;\n\nflow.set('azul_act', act);\nflow.set('azul_galga', galga);\nflow.set('azul_temp', temp);\n\n// Verificar si todas son true\nlet auto_on = act && galga && temp;\nflow.set('azul_auto_on', auto_on);\n\n// Publicar a LEDS\nnode.send([{payload: act}, {payload: galga}, {payload: temp}, {payload: auto_on}]);\nreturn null;",
        "outputs": 4,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 430,
        "wires": [
            [
                "86f2fdafd8d623bb"
            ],
            [
                "a73d659dec6d2750"
            ],
            [
                "9537c6f830f01649"
            ],
            [
                "d8fef3ad6cdf7260"
            ]
        ]
    },
    {
        "id": "86f2fdafd8d623bb",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 1,
        "group": "ui_azul",
        "width": "0",
        "height": "0",
        "label": "Activación",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 740,
        "y": 380,
        "wires": []
    },
    {
        "id": "a73d659dec6d2750",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 2,
        "group": "ui_azul",
        "width": "0",
        "height": "0",
        "label": "Galga",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 730,
        "y": 430,
        "wires": []
    },
    {
        "id": "9537c6f830f01649",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 3,
        "group": "ui_azul",
        "width": "0",
        "height": "0",
        "label": "Temperatura",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 740,
        "y": 480,
        "wires": []
    },
    {
        "id": "f92f3bc258cb031c",
        "type": "ui_switch",
        "z": "8167fc72ca67c031",
        "name": "Encendido Manual",
        "label": "Manual",
        "tooltip": "",
        "group": "ui_azul",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/azul/manual",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 210,
        "y": 560,
        "wires": [
            [
                "d8fef3ad6cdf7260"
            ]
        ]
    },
    {
        "id": "d8fef3ad6cdf7260",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Control Final Bomba Azul",
        "func": "let auto_on = flow.get('azul_auto_on') || false;\nlet manual = (msg.payload === true || msg.payload === 'true');\n\nlet estado = auto_on || manual;\nflow.set('azul_estado', estado);\n\nreturn [{payload: estado}, {payload: estado}];",
        "outputs": 2,
        "noerr": 0,
        "x": 490,
        "y": 560,
        "wires": [
            [
                "5af8abd3ac94bffa"
            ],
            [
                "51c7bb01ecf30119"
            ]
        ]
    },
    {
        "id": "5af8abd3ac94bffa",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 5,
        "group": "ui_azul",
        "width": "0",
        "height": "0",
        "label": "Bomba Azul",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 730,
        "y": 560,
        "wires": []
    },
    {
        "id": "51c7bb01ecf30119",
        "type": "mqtt out",
        "z": "8167fc72ca67c031",
        "name": "MQTT Estado Azul",
        "topic": "bomba/azul/estado",
        "qos": "2",
        "retain": "false",
        "broker": "",
        "x": 730,
        "y": 610,
        "wires": []
    },
    {
        "id": "04305e935ce81898",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Activación Amarilla",
        "topic": "bomba/amarilla/activacion",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 990,
        "y": 380,
        "wires": [
            [
                "c5dd5ae2e6a4eb10"
            ]
        ]
    },
    {
        "id": "0880c0d5b1709676",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Galga Amarilla",
        "topic": "bomba/amarilla/galga",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 990,
        "y": 430,
        "wires": [
            [
                "c5dd5ae2e6a4eb10"
            ]
        ]
    },
    {
        "id": "2ce72f5370411cc5",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Temperatura Amarilla",
        "topic": "bomba/amarilla/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1000,
        "y": 480,
        "wires": [
            [
                "c5dd5ae2e6a4eb10"
            ]
        ]
    },
    {
        "id": "c5dd5ae2e6a4eb10",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Lógica Bomba Amarilla",
        "func": "// Variables globales\nlet act = flow.get('amarilla_act') || false;\nlet galga = flow.get('amarilla_galga') || false;\nlet temp = flow.get('amarilla_temp') || false;\n\nact = msg.topic.includes('activacion') ? (msg.payload == true || msg.payload == 'true') : act;\ngalga = msg.topic.includes('galga') ? (msg.payload == true || msg.payload == 'true') : galga;\ntemp = msg.topic.includes('temperatura') ? (msg.payload == true || msg.payload == 'true') : temp;\n\nflow.set('amarilla_act', act);\nflow.set('amarilla_galga', galga);\nflow.set('amarilla_temp', temp);\n\nlet auto_on = act && galga && temp;\nflow.set('amarilla_auto_on', auto_on);\n\nnode.send([{payload: act}, {payload: galga}, {payload: temp}, {payload: auto_on}]);\nreturn null;",
        "outputs": 4,
        "x": 1280,
        "y": 430,
        "wires": [
            [
                "124016e47cb0b8bf"
            ],
            [
                "b1efca55b2a4c795"
            ],
            [
                "73571c87cbdb4cd9"
            ],
            [
                "2ddc2c7e2b30cbd2"
            ]
        ]
    },
    {
        "id": "124016e47cb0b8bf",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 1,
        "group": "6735fef8e0262102",
        "width": "0",
        "height": "0",
        "label": "Activación",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1530,
        "y": 380,
        "wires": []
    },
    {
        "id": "b1efca55b2a4c795",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 2,
        "group": "6735fef8e0262102",
        "width": "0",
        "height": "0",
        "label": "Galga",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1520,
        "y": 430,
        "wires": []
    },
    {
        "id": "73571c87cbdb4cd9",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 3,
        "group": "6735fef8e0262102",
        "width": "0",
        "height": "0",
        "label": "Temperatura",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1530,
        "y": 480,
        "wires": []
    },
    {
        "id": "7525ae1e51f2cc71",
        "type": "ui_switch",
        "z": "8167fc72ca67c031",
        "name": "Encendido Manual",
        "label": "Manual",
        "tooltip": "",
        "group": "6735fef8e0262102",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/amarilla/manual",
        "topicType": "str",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 1000,
        "y": 560,
        "wires": [
            [
                "2ddc2c7e2b30cbd2"
            ]
        ]
    },
    {
        "id": "2ddc2c7e2b30cbd2",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Control Final Bomba Amarilla",
        "func": "let auto_on = flow.get('amarilla_auto_on') || false;\nlet manual = (msg.payload === true || msg.payload === 'true');\n\nlet estado = auto_on || manual;\nflow.set('amarilla_estado', estado);\n\nreturn [{payload: estado}, {payload: estado}];",
        "outputs": 2,
        "x": 1280,
        "y": 560,
        "wires": [
            [
                "b0acaa7e5e56d0b1"
            ],
            [
                "4fe735f5b0a6a7e3"
            ]
        ]
    },
    {
        "id": "b0acaa7e5e56d0b1",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 5,
        "group": "6735fef8e0262102",
        "width": "0",
        "height": "0",
        "label": "Bomba Amarilla",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1520,
        "y": 560,
        "wires": []
    },
    {
        "id": "4fe735f5b0a6a7e3",
        "type": "mqtt out",
        "z": "8167fc72ca67c031",
        "name": "MQTT Estado Amarilla",
        "topic": "bomba/amarilla/estado",
        "qos": "2",
        "retain": "false",
        "broker": "",
        "x": 1520,
        "y": 610,
        "wires": []
    },
    {
        "id": "44d9f43c909373f9",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Activación Roja",
        "topic": "bomba/roja/activacion",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "inputs": 0,
        "x": 220,
        "y": 670,
        "wires": [
            [
                "1301b3c6401a60f4"
            ]
        ]
    },
    {
        "id": "e18ee7672e5c3757",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Galga Roja",
        "topic": "bomba/roja/galga",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "inputs": 0,
        "x": 220,
        "y": 720,
        "wires": [
            [
                "1301b3c6401a60f4"
            ]
        ]
    },
    {
        "id": "a74e014104e99ce6",
        "type": "mqtt in",
        "z": "8167fc72ca67c031",
        "name": "MQTT Temperatura Roja",
        "topic": "bomba/roja/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "",
        "inputs": 0,
        "x": 230,
        "y": 770,
        "wires": [
            [
                "1301b3c6401a60f4"
            ]
        ]
    },
    {
        "id": "1301b3c6401a60f4",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Lógica Bomba Roja",
        "func": "// Variables globales\nlet act = flow.get('roja_act') || false;\nlet galga = flow.get('roja_galga') || false;\nlet temp = flow.get('roja_temp') || false;\n\nact = msg.topic.includes('activacion') ? (msg.payload == true || msg.payload == 'true') : act;\ngalga = msg.topic.includes('galga') ? (msg.payload == true || msg.payload == 'true') : galga;\ntemp = msg.topic.includes('temperatura') ? (msg.payload == true || msg.payload == 'true') : temp;\n\nflow.set('roja_act', act);\nflow.set('roja_galga', galga);\nflow.set('roja_temp', temp);\n\nlet auto_on = act && galga && temp;\nflow.set('roja_auto_on', auto_on);\n\nnode.send([{payload: act}, {payload: galga}, {payload: temp}, {payload: auto_on}]);\nreturn null;",
        "outputs": 4,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 510,
        "y": 720,
        "wires": [
            [
                "a200e9e32fd80a27"
            ],
            [
                "5f1fbb722fe3952e"
            ],
            [
                "d5f09a8b85cc20de"
            ],
            [
                "4cf5518bc2c60e41"
            ]
        ]
    },
    {
        "id": "a200e9e32fd80a27",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 1,
        "group": "ui_group_roja",
        "width": "0",
        "height": "0",
        "label": "Activación",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 760,
        "y": 670,
        "wires": []
    },
    {
        "id": "5f1fbb722fe3952e",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 2,
        "group": "ui_group_roja",
        "width": "0",
        "height": "0",
        "label": "Galga",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 750,
        "y": 720,
        "wires": []
    },
    {
        "id": "d5f09a8b85cc20de",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 3,
        "group": "ui_group_roja",
        "width": "0",
        "height": "0",
        "label": "Temperatura",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 760,
        "y": 770,
        "wires": []
    },
    {
        "id": "8fac95d6922578f7",
        "type": "ui_switch",
        "z": "8167fc72ca67c031",
        "name": "Encendido Manual",
        "label": "Manual",
        "tooltip": "",
        "group": "ui_group_roja",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": true,
        "decouple": "false",
        "topic": "bomba/roja/manual",
        "topicType": "str",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 230,
        "y": 850,
        "wires": [
            [
                "4cf5518bc2c60e41"
            ]
        ]
    },
    {
        "id": "4cf5518bc2c60e41",
        "type": "function",
        "z": "8167fc72ca67c031",
        "name": "Control Final Bomba Roja",
        "func": "let auto_on = flow.get('roja_auto_on') || false;\nlet manual = (msg.payload === true || msg.payload === 'true');\n\nlet estado = auto_on || manual;\nflow.set('roja_estado', estado);\n\nreturn [{payload: estado}, {payload: estado}];",
        "outputs": 2,
        "x": 510,
        "y": 850,
        "wires": [
            [
                "3ad559dd3eaf4ae0"
            ],
            [
                "1e2ffc320e251d6e"
            ]
        ]
    },
    {
        "id": "3ad559dd3eaf4ae0",
        "type": "ui_led",
        "z": "8167fc72ca67c031",
        "order": 5,
        "group": "ui_group_roja",
        "width": "0",
        "height": "0",
        "label": "Bomba Roja",
        "labelPlacement": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            },
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 750,
        "y": 850,
        "wires": []
    },
    {
        "id": "1e2ffc320e251d6e",
        "type": "mqtt out",
        "z": "8167fc72ca67c031",
        "name": "MQTT Estado Roja",
        "topic": "bomba/roja/estado",
        "qos": "2",
        "retain": "false",
        "broker": "",
        "x": 750,
        "y": 900,
        "wires": []
    },
    {
        "id": "7cb924cb7518fca9",
        "type": "mqtt out",
        "z": "1e029c11f34910f2",
        "name": "",
        "topic": "bombas/MAGENTA",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2c5b539e522b2721",
        "x": 830,
        "y": 140,
        "wires": []
    },
    {
        "id": "3d70241cc9165622",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "ON MAGENTA",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "ON",
        "payloadType": "str",
        "topic": "bombas/MAGENTA",
        "topicType": "msg",
        "x": 600,
        "y": 40,
        "wires": [
            [
                "7cb924cb7518fca9"
            ]
        ]
    },
    {
        "id": "c7d0004803fd6421",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "OFF MAGENTA",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "OFF",
        "payloadType": "str",
        "topic": "bombas/MAGENTA",
        "topicType": "msg",
        "x": 600,
        "y": 100,
        "wires": [
            [
                "7cb924cb7518fca9"
            ]
        ]
    },
    {
        "id": "50026c12725454e4",
        "type": "mqtt out",
        "z": "1e029c11f34910f2",
        "name": "",
        "topic": "bombas/CYAN",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2c5b539e522b2721",
        "x": 400,
        "y": 140,
        "wires": []
    },
    {
        "id": "27e0391e409b6bd8",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "ON CYAN",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "ON",
        "payloadType": "str",
        "topic": "bombas/CYAN",
        "topicType": "msg",
        "x": 140,
        "y": 80,
        "wires": [
            [
                "50026c12725454e4"
            ]
        ]
    },
    {
        "id": "4c4056469540bfb2",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "OFF CYAN",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "OFF",
        "payloadType": "str",
        "topic": "bombas/CYAN",
        "topicType": "msg",
        "x": 130,
        "y": 140,
        "wires": [
            [
                "50026c12725454e4"
            ]
        ]
    },
    {
        "id": "0a92c4dd3a86cd1e",
        "type": "mqtt out",
        "z": "1e029c11f34910f2",
        "name": "",
        "topic": "bombas/YELLOW",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2c5b539e522b2721",
        "x": 410,
        "y": 300,
        "wires": []
    },
    {
        "id": "793e09a673d7e902",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "ON YELLOW",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "ON",
        "payloadType": "str",
        "topic": "bombas/YELLOW",
        "topicType": "msg",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "0a92c4dd3a86cd1e"
            ]
        ]
    },
    {
        "id": "c137101608f10cbd",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "OFF YELLOW",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "OFF",
        "payloadType": "str",
        "topic": "bombas/YELLOW",
        "topicType": "msg",
        "x": 180,
        "y": 260,
        "wires": [
            [
                "0a92c4dd3a86cd1e"
            ]
        ]
    },
    {
        "id": "8aaef2d3aa513857",
        "type": "mqtt out",
        "z": "1e029c11f34910f2",
        "name": "",
        "topic": "bombas/BLACK",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2c5b539e522b2721",
        "x": 820,
        "y": 300,
        "wires": []
    },
    {
        "id": "60c29f11e348963f",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "ON BLACK",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "ON",
        "payloadType": "str",
        "topic": "bombas/BLACK",
        "topicType": "msg",
        "x": 590,
        "y": 200,
        "wires": [
            [
                "8aaef2d3aa513857"
            ]
        ]
    },
    {
        "id": "f03e2e40c6b3726e",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "OFF BLACK",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "OFF",
        "payloadType": "str",
        "topic": "bombas/BLACK",
        "topicType": "msg",
        "x": 590,
        "y": 260,
        "wires": [
            [
                "8aaef2d3aa513857"
            ]
        ]
    },
    {
        "id": "7f202b7e8871b5c0",
        "type": "mqtt out",
        "z": "1e029c11f34910f2",
        "name": "",
        "topic": "bombas/WHITE",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2c5b539e522b2721",
        "x": 400,
        "y": 460,
        "wires": []
    },
    {
        "id": "af11286b6c50ad76",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "ON WHITE",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "ON",
        "payloadType": "str",
        "topic": "bombas/WHITE",
        "topicType": "msg",
        "x": 170,
        "y": 360,
        "wires": [
            [
                "7f202b7e8871b5c0"
            ]
        ]
    },
    {
        "id": "8e2fa390dae47340",
        "type": "ui_button",
        "z": "1e029c11f34910f2",
        "name": "",
        "group": "dae114c04a396a81",
        "order": 44,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "OFF WHITE",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "OFF",
        "payloadType": "str",
        "topic": "bombas/WHITE",
        "topicType": "msg",
        "x": 170,
        "y": 420,
        "wires": [
            [
                "7f202b7e8871b5c0"
            ]
        ]
    },
    {
        "id": "7212f4177094e558",
        "type": "function",
        "z": "a38a6f1d49ba3af3",
        "name": "PWM agitador → número",
        "func": "msg.payload = Number(msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 100,
        "wires": [
            [
                "cc8f0b0f60457fe5",
                "da6193fbd655702f"
            ]
        ]
    },
    {
        "id": "cc8f0b0f60457fe5",
        "type": "ui_gauge",
        "z": "a38a6f1d49ba3af3",
        "name": "Velocidad agitador",
        "group": "435156eae1fe1a22",
        "order": 2,
        "width": "6",
        "height": "5",
        "gtype": "gage",
        "title": "Velocidad agitador",
        "label": "%",
        "format": "{{msg.payload}}",
        "min": 0,
        "max": 100,
        "colors": [
            "#d3d3d3",
            "#66ccff",
            "#007acc"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 670,
        "y": 80,
        "wires": []
    },
    {
        "id": "da6193fbd655702f",
        "type": "ui_chart",
        "z": "a38a6f1d49ba3af3",
        "name": "PWM agitador — histórico",
        "group": "435156eae1fe1a22",
        "order": 3,
        "width": "12",
        "height": "4",
        "label": "PWM agitador — histórico",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Esperando datos...",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": "60",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#007acc",
            "#aec7e8",
            "#ff7f0e"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 690,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "27b40b847e04b445",
        "type": "mqtt in",
        "z": "a38a6f1d49ba3af3",
        "name": "Estado agitador",
        "topic": "agitador/estado",
        "qos": "2",
        "datatype": "auto",
        "broker": "bd0e2e04f12ac3cb",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 200,
        "wires": [
            [
                "ade2dddc9e0e69f4"
            ]
        ]
    },
    {
        "id": "ade2dddc9e0e69f4",
        "type": "ui_text",
        "z": "a38a6f1d49ba3af3",
        "group": "435156eae1fe1a22",
        "order": 1,
        "width": "12",
        "height": "1",
        "name": "Texto estado agitador",
        "label": "Estado actual:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 460,
        "y": 200,
        "wires": []
    },
    {
        "id": "5b9155a3401c8258",
        "type": "function",
        "z": "a38a6f1d49ba3af3",
        "name": "LED agitador",
        "func": "let pwm = Number(msg.payload);\n// true = encendido, false = apagado\nmsg.payload = pwm > 0;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 150,
        "wires": [
            [
                "2d3c1c22491458af"
            ]
        ]
    },
    {
        "id": "2d3c1c22491458af",
        "type": "ui_led",
        "z": "a38a6f1d49ba3af3",
        "order": 4,
        "group": "435156eae1fe1a22",
        "width": 0,
        "height": 0,
        "label": "Motor agitador",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            },
            {
                "color": "#00ff00",
                "value": "true",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": true,
        "shape": "circle",
        "name": "LED agitador",
        "x": 680,
        "y": 160,
        "wires": []
    },
    {
        "id": "4e83b208f5afaf81",
        "type": "mqtt in",
        "z": "a38a6f1d49ba3af3",
        "name": "Posición elevador",
        "topic": "elevador/posicion",
        "qos": "2",
        "datatype": "auto",
        "broker": "bd0e2e04f12ac3cb",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 320,
        "wires": [
            [
                "514f640304d36c5c"
            ]
        ]
    },
    {
        "id": "514f640304d36c5c",
        "type": "function",
        "z": "a38a6f1d49ba3af3",
        "name": "Posición → número",
        "func": "msg.payload = Number(msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 320,
        "wires": [
            [
                "e5f279f7896eaf27"
            ]
        ]
    },
    {
        "id": "24b55face73af917",
        "type": "ui_text",
        "z": "a38a6f1d49ba3af3",
        "group": "1fc3c77d74f3a787",
        "order": 4,
        "width": "6",
        "height": "1",
        "name": "Texto rango elevador",
        "label": "",
        "format": "0% arriba — 100% abajo",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 720,
        "y": 380,
        "wires": []
    },
    {
        "id": "8a6e762209291517",
        "type": "mqtt in",
        "z": "a38a6f1d49ba3af3",
        "name": "Estado elevador",
        "topic": "elevador/estado",
        "qos": "2",
        "datatype": "auto",
        "broker": "bd0e2e04f12ac3cb",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 380,
        "wires": [
            [
                "260f6688d7378349",
                "e3b785f989e4667d"
            ]
        ]
    },
    {
        "id": "260f6688d7378349",
        "type": "ui_text",
        "z": "a38a6f1d49ba3af3",
        "group": "1fc3c77d74f3a787",
        "order": 1,
        "width": "12",
        "height": "1",
        "name": "Texto estado elevador",
        "label": "Estado elevador:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 470,
        "y": 380,
        "wires": []
    },
    {
        "id": "e3b785f989e4667d",
        "type": "function",
        "z": "a38a6f1d49ba3af3",
        "name": "LED elevador",
        "func": "let estado = String(msg.payload).trim();\n// true = en movimiento, false = reposo\nmsg.payload = (estado !== \"reposo\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 430,
        "wires": [
            [
                "e02f5486c34a732a"
            ]
        ]
    },
    {
        "id": "e02f5486c34a732a",
        "type": "ui_led",
        "z": "a38a6f1d49ba3af3",
        "order": 3,
        "group": "1fc3c77d74f3a787",
        "width": 0,
        "height": 0,
        "label": "Motor elevador",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            },
            {
                "color": "#0000ff",
                "value": "true",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": true,
        "shape": "circle",
        "showGlow": true,
        "name": "LED elevador",
        "x": 690,
        "y": 430,
        "wires": []
    },
    {
        "id": "d51e011fde62127f",
        "type": "ui_button",
        "z": "a38a6f1d49ba3af3",
        "name": "INICIAR",
        "group": "435156eae1fe1a22",
        "order": 5,
        "width": 4,
        "height": 1,
        "label": "▶ INICIAR",
        "tooltip": "",
        "color": "#ffffff",
        "bgcolor": "#2196F3",
        "className": "",
        "icon": "",
        "payload": "iniciar 70 60",
        "payloadType": "str",
        "topic": "",
        "x": 170,
        "y": 500,
        "wires": [
            [
                "a5d119693cc21e31"
            ]
        ]
    },
    {
        "id": "3474a75a687b26af",
        "type": "ui_button",
        "z": "a38a6f1d49ba3af3",
        "name": "DETENER",
        "group": "435156eae1fe1a22",
        "order": 6,
        "width": 4,
        "height": 1,
        "label": "■ DETENER",
        "tooltip": "",
        "color": "#ffffff",
        "bgcolor": "#F44336",
        "className": "",
        "icon": "",
        "payload": "detener",
        "payloadType": "str",
        "topic": "",
        "x": 380,
        "y": 500,
        "wires": [
            [
                "a5d119693cc21e31"
            ]
        ]
    },
    {
        "id": "a5d119693cc21e31",
        "type": "mqtt out",
        "z": "a38a6f1d49ba3af3",
        "name": "Control agitador",
        "topic": "agitador/control",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "bd0e2e04f12ac3cb",
        "x": 640,
        "y": 500,
        "wires": []
    },
    {
        "id": "e5f279f7896eaf27",
        "type": "ui_level",
        "z": "a38a6f1d49ba3af3",
        "group": "1fc3c77d74f3a787",
        "order": 2,
        "width": "4",
        "height": 6,
        "name": "Posición Elevador",
        "label": "Posición Elevador",
        "colorHi": "#007acc",
        "colorWarn": "#66ccff",
        "colorNormal": "#d3d3d3",
        "colorOff": "#000000",
        "min": "0",
        "max": "100",
        "segWarn": 50,
        "segHigh": 90,
        "unit": "",
        "layout": "sv",
        "channelA": "Posición",
        "channelB": "0–100%",
        "decimals": 0,
        "animations": "soft",
        "shape": "1",
        "colorText": "#000000",
        "fontLabel": "",
        "fontValue": "",
        "fontSmall": "",
        "colorFromTheme": true,
        "textAnimations": false,
        "hideValue": false,
        "tickmode": "off",
        "peakmode": false,
        "property": "payload",
        "peaktime": "",
        "x": 690,
        "y": 320,
        "wires": []
    },
    {
        "id": "07dcc2ec3f72ead0",
        "type": "mqtt in",
        "z": "4baa40181dbb5c48",
        "name": "Color ESP32",
        "topic": "in/micro/sensor/color",
        "qos": "0",
        "datatype": "auto-detect",
        "broker": "89b5767d2d6aab10",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 230,
        "y": 160,
        "wires": [
            [
                "b5ba90f29bb17897",
                "d202f3c5bc9eb57e"
            ]
        ]
    },
    {
        "id": "b5ba90f29bb17897",
        "type": "function",
        "z": "4baa40181dbb5c48",
        "name": "Dividir RGB",
        "func": "let R = msg.payload.R;\nlet G = msg.payload.G;\nlet B = msg.payload.B;\n\nreturn [\n    {payload: R, topic: \"R\"},\n    {payload: G, topic: \"G\"},\n    {payload: B, topic: \"B\"}\n];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 100,
        "wires": [
            [
                "86ba3c986a6a54f3"
            ],
            [
                "b7ed8d3a7458831d"
            ],
            [
                "8dddaaf35034f84c"
            ]
        ]
    },
    {
        "id": "86ba3c986a6a54f3",
        "type": "ui_gauge",
        "z": "4baa40181dbb5c48",
        "name": "Rojo (R)",
        "group": "8670a6f1862a55ea",
        "order": 2,
        "width": "3",
        "height": "2",
        "gtype": "donut",
        "title": "Rojo (R)",
        "label": "R",
        "format": "{{value}}",
        "min": 0,
        "max": 255,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 720,
        "y": 40,
        "wires": []
    },
    {
        "id": "b7ed8d3a7458831d",
        "type": "ui_gauge",
        "z": "4baa40181dbb5c48",
        "name": "Verde (G)",
        "group": "8670a6f1862a55ea",
        "order": 3,
        "width": "3",
        "height": "2",
        "gtype": "donut",
        "title": "Verde (G)",
        "label": "G",
        "format": "{{value}}",
        "min": 0,
        "max": 255,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 720,
        "y": 100,
        "wires": []
    },
    {
        "id": "8dddaaf35034f84c",
        "type": "ui_gauge",
        "z": "4baa40181dbb5c48",
        "name": "Azul (B)",
        "group": "8670a6f1862a55ea",
        "order": 4,
        "width": "3",
        "height": "2",
        "gtype": "donut",
        "title": "Azul (B)",
        "label": "B",
        "format": "{{value}}",
        "min": 0,
        "max": 255,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 720,
        "y": 160,
        "wires": []
    },
    {
        "id": "7833b74d4b84571a",
        "type": "ui_template",
        "z": "4baa40181dbb5c48",
        "group": "8670a6f1862a55ea",
        "name": "Color Detectado",
        "order": 13,
        "width": "10",
        "height": "4",
        "format": "<div style=\"text-align:center\">\n    <h2>Color Detectado</h2>\n    <div id=\"colorBox\" style=\"width:600px;height:150px;margin:auto;border-radius:10px;border:2px solid #555;\"></div>\n    <p id=\"rgbText\"></p>\n</div>\n\n<script>\n    (function(scope) {\n    scope.$watch('msg.payload', function(payload) {\n        if (payload) {\n            var r = payload.r || 0;\n            var g = payload.g || 0;\n            var b = payload.b || 0;\n            var color = \"rgb(\" + r + \",\" + g + \",\" + b + \")\";\n            document.getElementById(\"colorBox\").style.backgroundColor = color;\n            document.getElementById(\"rgbText\").innerText = color;\n        }\n    });\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 740,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "d202f3c5bc9eb57e",
        "type": "function",
        "z": "4baa40181dbb5c48",
        "name": "Agrupar RGB",
        "func": "let R = msg.payload.R;\nlet G = msg.payload.G;\nlet B = msg.payload.B;\n\nmsg.payload = { r: R, g: G, b: B };\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 240,
        "wires": [
            [
                "7833b74d4b84571a"
            ]
        ]
    },
    {
        "id": "1c0ff1883c1f846a",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp1/temperatura/sensor1",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 140,
        "wires": [
            [
                "9f6318280c117fb1",
                "162838df72eae425"
            ]
        ]
    },
    {
        "id": "898b16741ad7a53b",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp1/temperatura/sensor2",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 200,
        "wires": [
            [
                "9605dce9e88c116d",
                "86b7b13bd1786db2"
            ]
        ]
    },
    {
        "id": "5819bc1d48341699",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp1/temperatura/sensor3",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 260,
        "wires": [
            [
                "4dcce8e4ed07ded7",
                "4bacc0ba9538aa54"
            ]
        ]
    },
    {
        "id": "835cb75069196a43",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp1/temperatura/sensor4",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 320,
        "wires": [
            [
                "7e6af3684fad9b39",
                "b8ebdb26085059f7"
            ]
        ]
    },
    {
        "id": "d1c08ed7c960d08c",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp1/temperatura/sensor5",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 250,
        "y": 380,
        "wires": [
            [
                "8f047e8c443abcde",
                "5f7d338c35bbcac7"
            ]
        ]
    },
    {
        "id": "162838df72eae425",
        "type": "function",
        "z": "bdbe7f8f0b413356",
        "name": "function 2",
        "func": "// === Función Sensor1 -> 3 salidas ===\n\n// Convierte el valor recibido a número\nlet temp = parseFloat(msg.payload);\nif (isNaN(temp)) { return null; }  // Si no es número, no hace nada\n\n// Umbral para activar la válvula\nconst UMBRAL = 30.0;\nlet estado = (temp >= UMBRAL) ? \"ON\" : \"OFF\";\n\n// === Topics MQTT ===\nlet sensorTopic = \"esp1/temperatura/sensor1\";   // Publica la temperatura medida\nlet valveTopic = \"esp2/pintura/valvula1\";      // Orden ON/OFF para la válvula\n\n// === Mensajes de salida ===\nlet msgValve = { topic: valveTopic, payload: estado };         // Activa/desactiva la válvula\nlet msgSensor = { topic: sensorTopic, payload: temp.toFixed(2) }; // Envía solo el valor de temperatura\nlet msgLed = { payload: estado };                               // Para el LED o indicador\n\n// === Retorna 3 salidas ===\n// [1] Válvula   [2] Sensor (temperatura)   [3] LED o dashboard\nreturn [msgValve, msgSensor, msgLed];\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 100,
        "wires": [
            [
                "dff56d2bc3299d93",
                "bc0c54689d3cfe51"
            ]
        ]
    },
    {
        "id": "dff56d2bc3299d93",
        "type": "mqtt out",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula1",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "0680cbe3d040e0fd",
        "x": 900,
        "y": 100,
        "wires": []
    },
    {
        "id": "bc0c54689d3cfe51",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 31,
        "group": "42b625a52eaeccee",
        "width": "2",
        "height": "1",
        "label": "Válvula 1",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led1",
        "x": 850,
        "y": 60,
        "wires": []
    },
    {
        "id": "86b7b13bd1786db2",
        "type": "function",
        "z": "bdbe7f8f0b413356",
        "name": "function 4",
        "func": "// === Función Sensor2 -> 3 salidas ===\n\n// Convierte el valor recibido a número\nlet temp = parseFloat(msg.payload);\nif (isNaN(temp)) { return null; }  // Si no es número, no hace nada\n\n// Umbral para activar la válvula\nconst UMBRAL = 30.0;\nlet estado = (temp >= UMBRAL) ? \"ON\" : \"OFF\";\n\n// === Topics MQTT ===\nlet sensorTopic = \"esp1/temperatura/sensor2\";   // Publica la temperatura medida\nlet valveTopic = \"esp2/pintura/valvula2\";      // Orden ON/OFF para la válvula\n\n// === Mensajes de salida ===\nlet msgValve = { topic: valveTopic, payload: estado };         // Activa/desactiva la válvula\nlet msgSensor = { topic: sensorTopic, payload: temp.toFixed(2) }; // Envía solo el valor de temperatura\nlet msgLed = { payload: estado };                               // Para el LED o indicador\n\n// === Retorna 3 salidas ===\n// [1] Válvula   [2] Sensor (temperatura)   [3] LED o dashboard\nreturn [msgValve, msgSensor, msgLed];\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 180,
        "wires": [
            [
                "f7774474e6169a94",
                "3acf2cc109cb2988"
            ]
        ]
    },
    {
        "id": "f7774474e6169a94",
        "type": "mqtt out",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula2",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "0680cbe3d040e0fd",
        "x": 900,
        "y": 180,
        "wires": []
    },
    {
        "id": "3acf2cc109cb2988",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 33,
        "group": "42b625a52eaeccee",
        "width": "2",
        "height": "1",
        "label": "Valvula 2",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led2",
        "x": 850,
        "y": 140,
        "wires": []
    },
    {
        "id": "4bacc0ba9538aa54",
        "type": "function",
        "z": "bdbe7f8f0b413356",
        "name": "function 5",
        "func": "// === Función Sensor3 -> 3 salidas ===\n\n// Convierte el valor recibido a número\nlet temp = parseFloat(msg.payload);\nif (isNaN(temp)) { return null; }  // Si no es número, no hace nada\n\n// Umbral para activar la válvula\nconst UMBRAL = 30.0;\nlet estado = (temp >= UMBRAL) ? \"ON\" : \"OFF\";\n\n// === Topics MQTT ===\nlet sensorTopic = \"esp1/temperatura/sensor3\";   // Publica la temperatura medida\nlet valveTopic = \"esp2/pintura/valvula3\";      // Orden ON/OFF para la válvula\n\n// === Mensajes de salida ===\nlet msgValve = { topic: valveTopic, payload: estado };         // Activa/desactiva la válvula\nlet msgSensor = { topic: sensorTopic, payload: temp.toFixed(2) }; // Envía solo el valor de temperatura\nlet msgLed = { payload: estado };                               // Para el LED o indicador\n\n// === Retorna 3 salidas ===\n// [1] Válvula   [2] Sensor (temperatura)   [3] LED o dashboard\nreturn [msgValve, msgSensor, msgLed];\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 260,
        "wires": [
            [
                "03579f860c8fb823",
                "5f294882ee337e7c"
            ]
        ]
    },
    {
        "id": "03579f860c8fb823",
        "type": "mqtt out",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula3",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "0680cbe3d040e0fd",
        "x": 900,
        "y": 260,
        "wires": []
    },
    {
        "id": "5f294882ee337e7c",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 35,
        "group": "42b625a52eaeccee",
        "width": "2",
        "height": "1",
        "label": "Valvula 3",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led3",
        "x": 850,
        "y": 220,
        "wires": []
    },
    {
        "id": "b8ebdb26085059f7",
        "type": "function",
        "z": "bdbe7f8f0b413356",
        "name": "function 6",
        "func": "// === Función Sensor4 -> 3 salidas ===\n\n// Convierte el valor recibido a número\nlet temp = parseFloat(msg.payload);\nif (isNaN(temp)) { return null; }  // Si no es número, no hace nada\n\n// Umbral para activar la válvula\nconst UMBRAL = 30.0;\nlet estado = (temp >= UMBRAL) ? \"ON\" : \"OFF\";\n\n// === Topics MQTT ===\nlet sensorTopic = \"esp1/temperatura/sensor4\";   // Publica la temperatura medida\nlet valveTopic = \"esp2/pintura/valvula4\";      // Orden ON/OFF para la válvula\n\n// === Mensajes de salida ===\nlet msgValve = { topic: valveTopic, payload: estado };         // Activa/desactiva la válvula\nlet msgSensor = { topic: sensorTopic, payload: temp.toFixed(2) }; // Envía solo el valor de temperatura\nlet msgLed = { payload: estado };                               // Para el LED o indicador\n\n// === Retorna 3 salidas ===\n// [1] Válvula   [2] Sensor (temperatura)   [3] LED o dashboard\nreturn [msgValve, msgSensor, msgLed];",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 340,
        "wires": [
            [
                "810e376b13d35d33",
                "c25bd604452f69ec"
            ]
        ]
    },
    {
        "id": "810e376b13d35d33",
        "type": "mqtt out",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula4",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "0680cbe3d040e0fd",
        "x": 900,
        "y": 340,
        "wires": []
    },
    {
        "id": "c25bd604452f69ec",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 37,
        "group": "42b625a52eaeccee",
        "width": "2",
        "height": "1",
        "label": "Valvula 4",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led4",
        "x": 850,
        "y": 300,
        "wires": []
    },
    {
        "id": "5f7d338c35bbcac7",
        "type": "function",
        "z": "bdbe7f8f0b413356",
        "name": "function 7",
        "func": "// === Función Sensor5 -> 3 salidas ===\n\n// Convierte el valor recibido a número\nlet temp = parseFloat(msg.payload);\nif (isNaN(temp)) { return null; }  // Si no es número, no hace nada\n\n// Umbral para activar la válvula\nconst UMBRAL = 30.0;\nlet estado = (temp >= UMBRAL) ? \"ON\" : \"OFF\";\n\n// === Topics MQTT ===\nlet sensorTopic = \"esp1/temperatura/sensor5\";   // Publica la temperatura medida\nlet valveTopic = \"esp2/pintura/valvula5\";      // Orden ON/OFF para la válvula\n\n// === Mensajes de salida ===\nlet msgValve = { topic: valveTopic, payload: estado };         // Activa/desactiva la válvula\nlet msgSensor = { topic: sensorTopic, payload: temp.toFixed(2) }; // Envía solo el valor de temperatura\nlet msgLed = { payload: estado };                               // Para el LED o indicador\n\n// === Retorna 3 salidas ===\n// [1] Válvula   [2] Sensor (temperatura)   [3] LED o dashboard\nreturn [msgValve, msgSensor, msgLed];",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 420,
        "wires": [
            [
                "645ac857d0597e3a",
                "0843d1117ff644d2"
            ]
        ]
    },
    {
        "id": "645ac857d0597e3a",
        "type": "mqtt out",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula5",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "0680cbe3d040e0fd",
        "x": 910,
        "y": 420,
        "wires": []
    },
    {
        "id": "0843d1117ff644d2",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 39,
        "group": "42b625a52eaeccee",
        "width": "2",
        "height": "1",
        "label": "Valvula 5",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led5",
        "x": 860,
        "y": 380,
        "wires": []
    },
    {
        "id": "367c521719132d94",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula1",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 500,
        "wires": [
            [
                "3ecb3e2d273310ba"
            ]
        ]
    },
    {
        "id": "4ce0f01c559deb83",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 40,
        "group": "6069fce9c8d0f810",
        "width": 3,
        "height": 1,
        "label": "Led3",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led3",
        "x": 530,
        "y": 660,
        "wires": []
    },
    {
        "id": "3ecb3e2d273310ba",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 36,
        "group": "6069fce9c8d0f810",
        "width": "2",
        "height": 1,
        "label": "Led1",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led1",
        "x": 530,
        "y": 500,
        "wires": []
    },
    {
        "id": "752f5a435ab5265a",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 38,
        "group": "6069fce9c8d0f810",
        "width": 3,
        "height": 1,
        "label": "Led2",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led2",
        "x": 530,
        "y": 580,
        "wires": []
    },
    {
        "id": "babc9c3eab2672b5",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 42,
        "group": "6069fce9c8d0f810",
        "width": 3,
        "height": 1,
        "label": "Led4",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led4",
        "x": 530,
        "y": 740,
        "wires": []
    },
    {
        "id": "9b5ccef4ed5c49f8",
        "type": "ui_led",
        "z": "bdbe7f8f0b413356",
        "order": 44,
        "group": "6069fce9c8d0f810",
        "width": 3,
        "height": 1,
        "label": "Led5",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "OFF",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "ON",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Led5",
        "x": 540,
        "y": 820,
        "wires": []
    },
    {
        "id": "56e68a00b18ac996",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula4",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 740,
        "wires": [
            [
                "babc9c3eab2672b5"
            ]
        ]
    },
    {
        "id": "0d3ae5ad88a41bfa",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula3",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 660,
        "wires": [
            [
                "4ce0f01c559deb83"
            ]
        ]
    },
    {
        "id": "7c55f13d1284031e",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula2",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 580,
        "wires": [
            [
                "752f5a435ab5265a"
            ]
        ]
    },
    {
        "id": "24305fe2eeb17075",
        "type": "mqtt in",
        "z": "bdbe7f8f0b413356",
        "name": "",
        "topic": "esp2/pintura/valvula5",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "0680cbe3d040e0fd",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 820,
        "wires": [
            [
                "9b5ccef4ed5c49f8"
            ]
        ]
    },
    {
        "id": "9f6318280c117fb1",
        "type": "ui_widget_thermometer",
        "z": "bdbe7f8f0b413356",
        "group": "f0b91852e4d33cff",
        "order": 1,
        "width": "2",
        "height": "5",
        "name": "Sensor1",
        "title": "Sensor1",
        "numColor": 3,
        "colorTop": "#2196f3",
        "colorMiddle": "#8bc34a",
        "colorBottom": "#f44336",
        "unit": "°C",
        "scale": "normal",
        "minTemp": 0,
        "maxTemp": "50",
        "minTempMoreThanMaxTemp": "1",
        "numberOfDecimals": "0",
        "showPercentage": "0",
        "currentTempFontSize": "1.2",
        "x": 480,
        "y": 140,
        "wires": []
    },
    {
        "id": "9605dce9e88c116d",
        "type": "ui_widget_thermometer",
        "z": "bdbe7f8f0b413356",
        "group": "f0b91852e4d33cff",
        "order": 3,
        "width": "2",
        "height": "5",
        "name": "Sensor2",
        "title": "Sensor2",
        "numColor": 3,
        "colorTop": "#2196f3",
        "colorMiddle": "#8bc34a",
        "colorBottom": "#f44336",
        "unit": "°C",
        "scale": "normal",
        "minTemp": 0,
        "maxTemp": "50",
        "minTempMoreThanMaxTemp": "1",
        "numberOfDecimals": "0",
        "showPercentage": "0",
        "currentTempFontSize": "1.2",
        "x": 480,
        "y": 200,
        "wires": []
    },
    {
        "id": "4dcce8e4ed07ded7",
        "type": "ui_widget_thermometer",
        "z": "bdbe7f8f0b413356",
        "group": "f0b91852e4d33cff",
        "order": 5,
        "width": "2",
        "height": "5",
        "name": "Sensor3",
        "title": "Sensor3",
        "numColor": 3,
        "colorTop": "#2196f3",
        "colorMiddle": "#8bc34a",
        "colorBottom": "#f44336",
        "unit": "°C",
        "scale": "normal",
        "minTemp": 0,
        "maxTemp": "50",
        "minTempMoreThanMaxTemp": "1",
        "numberOfDecimals": "0",
        "showPercentage": "0",
        "currentTempFontSize": "1.2",
        "x": 480,
        "y": 260,
        "wires": []
    },
    {
        "id": "7e6af3684fad9b39",
        "type": "ui_widget_thermometer",
        "z": "bdbe7f8f0b413356",
        "group": "f0b91852e4d33cff",
        "order": 7,
        "width": "2",
        "height": "5",
        "name": "Sensor4",
        "title": "Sensor4",
        "numColor": 3,
        "colorTop": "#2196f3",
        "colorMiddle": "#8bc34a",
        "colorBottom": "#f44336",
        "unit": "°C",
        "scale": "normal",
        "minTemp": 0,
        "maxTemp": "50",
        "minTempMoreThanMaxTemp": "1",
        "numberOfDecimals": "0",
        "showPercentage": "0",
        "currentTempFontSize": "1.2",
        "x": 480,
        "y": 320,
        "wires": []
    },
    {
        "id": "8f047e8c443abcde",
        "type": "ui_widget_thermometer",
        "z": "bdbe7f8f0b413356",
        "group": "f0b91852e4d33cff",
        "order": 9,
        "width": "2",
        "height": "5",
        "name": "Sensor5",
        "title": "Sensor5",
        "numColor": 3,
        "colorTop": "#2196f3",
        "colorMiddle": "#8bc34a",
        "colorBottom": "#f44336",
        "unit": "°C",
        "scale": "normal",
        "minTemp": 0,
        "maxTemp": "50",
        "minTempMoreThanMaxTemp": "1",
        "numberOfDecimals": "0",
        "showPercentage": "0",
        "currentTempFontSize": "1.2",
        "x": 480,
        "y": 380,
        "wires": []
    },
    {
        "id": "8c8ae91da1be57e6",
        "type": "ui_template",
        "z": "633db782b5e59011",
        "group": "0dbc51b5a13e11e4",
        "name": "",
        "order": 4,
        "width": "0",
        "height": "0",
        "format": "<div style=\"text-align:center;\">\n    <h3>Selecciona un punto de la imagen</h3>\n    <canvas id=\"canvas\" width=\"640\" height=\"480\" style=\"border:1px solid #000;\"></canvas>\n    <p id=\"colorInfo\">Haz clic en un punto de la imagen</p>\n</div>\n\n<script>\n    (function(scope) {\n    const canvas = document.getElementById(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    const colorInfo = document.getElementById(\"colorInfo\");\n    let img = new Image();\n\n    scope.$watch('msg.payload', function(data) {\n        if (!data) return;\n        img = new Image();\n        img.onload = function() {\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n        };\n        img.src = data;\n    });\n\n    // NUEVA función: convierte r,g,b (0..255) a CMYKW normalizados que sumen 100\n    function rgbToCMYKW(r, g, b) {\n        // normalizamos 0..1\n        let R = r / 255;\n        let G = g / 255;\n        let B = b / 255;\n\n        // CMY base (sustractivo simple)\n        let C = 1 - R;\n        let M = 1 - G;\n        let Y = 1 - B;\n\n        // K = min(C,M,Y) (parte negra que se puede extraer)\n        let K = Math.min(C, M, Y);\n\n        // Partes residuales de CMY después de extraer K\n        let Cr = Math.max(0, C - K);\n        let Mr = Math.max(0, M - K);\n        let Yr = Math.max(0, Y - K);\n\n        // W (blanco) — lo que sobra hasta 1 si la suma de componentes es < 1\n        // Calculamos suma física sin normalizar\n        let rawSum = Cr + Mr + Yr + K;\n        let W = 0;\n        if (rawSum < 1) {\n            W = 1 - rawSum;\n        } else {\n            W = 0;\n        }\n\n        // Ahora normalizamos para que C+M+Y+K+W = 1 (siempre)\n        let total = Cr + Mr + Yr + K + W;\n        if (total <= 0) total = 1; // seguridad\n\n        let Cn = Cr / total;\n        let Mn = Mr / total;\n        let Yn = Yr / total;\n        let Kn = K  / total;\n        let Wn = W  / total;\n\n        // convertir a porcentajes enteros\n        let Cperc = Math.round(Cn * 100);\n        let Mperc = Math.round(Mn * 100);\n        let Yperc = Math.round(Yn * 100);\n        let Kperc = Math.round(Kn * 100);\n        let Wperc = Math.round(Wn * 100);\n\n        // ajustar redondeo para que sumen exactamente 100\n        let arr = [\n            {k:'C', v:Cperc},\n            {k:'M', v:Mperc},\n            {k:'Y', v:Yperc},\n            {k:'K', v:Kperc},\n            {k:'W', v:Wperc}\n        ];\n        let sum = Cperc + Mperc + Yperc + Kperc + Wperc;\n        let diff = 100 - sum;\n\n        if (diff !== 0) {\n            // encontrar el componente con mayor valor (para ajustar ahí)\n            arr.sort((a,b) => b.v - a.v);\n            arr[0].v += diff; // puede ser negativo o positivo\n        }\n\n        // reconstruir objeto final\n        let result = {\n            C: arr.find(x=>x.k==='C').v,\n            M: arr.find(x=>x.k==='M').v,\n            Y: arr.find(x=>x.k==='Y').v,\n            K: arr.find(x=>x.k==='K').v,\n            W: arr.find(x=>x.k==='W').v\n        };\n\n        return result;\n    }\n\n    // Detectar clic\n    canvas.addEventListener(\"click\", function(event) {\n        const rect = canvas.getBoundingClientRect();\n        const x = event.clientX - rect.left;\n        const y = event.clientY - rect.top;\n\n        const pixel = ctx.getImageData(x, y, 1, 1).data;\n        const r = pixel[0];\n        const g = pixel[1];\n        const b = pixel[2];\n\n        const rgb = `rgb(${r}, ${g}, ${b})`;\n        const hex = \"#\" + ((1 << 24) + (r << 16) + (g << 8) + b)\n            .toString(16).slice(1).toUpperCase();\n\n        const cmykw = rgbToCMYKW(r, g, b);\n\n        const texto = `Coordenadas: (${Math.round(x)},${Math.round(y)}) - ${rgb} - ${hex} - C:${cmykw.C} M:${cmykw.M} Y:${cmykw.Y} K:${cmykw.K} W:${cmykw.W}`;\n\n        colorInfo.innerText = texto;\n\n        // Enviar a Node-RED (payload con todo)\n        scope.send({\n            payload: {\n                x: Math.round(x),\n                y: Math.round(y),\n                rgb: [r, g, b],\n                hex: hex,\n                C: cmykw.C,\n                M: cmykw.M,\n                Y: cmykw.Y,\n                K: cmykw.K,\n                W: cmykw.W,\n                texto: texto\n            }\n        });\n    });\n\n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 380,
        "y": 140,
        "wires": [
            [
                "45495d1d7a5fa5be"
            ]
        ]
    },
    {
        "id": "45495d1d7a5fa5be",
        "type": "function",
        "z": "633db782b5e59011",
        "name": "Procesar_color",
        "func": "// espera msg.payload = {x, y, rgb:[r,g,b], hex:\"#RRGGBB\"}\n\nlet info = msg.payload || {};\nlet hex = info.hex || \"#000000\";\nlet rgb = info.rgb || [0, 0, 0];\nlet x = info.x;\nlet y = info.y;\n\n// --------- CALCULAR CMYKW ---------\nlet R = (rgb[0] || 0) / 255;\nlet G = (rgb[1] || 0) / 255;\nlet B = (rgb[2] || 0) / 255;\n\nlet K = 1 - Math.max(R, G, B);\nlet denom = (1 - K) || 1;\nlet C = ((1 - R - K) / denom) || 0;\nlet M = ((1 - G - K) / denom) || 0;\nlet Y = ((1 - B - K) / denom) || 0;\n\n// Blanco simple\nlet W = Math.min(R, G, B);\n\n// Convertir a %\nC = Math.round(C * 100);\nM = Math.round(M * 100);\nY = Math.round(Y * 100);\nK = Math.round(K * 100);\nW = Math.round(W * 100);\n\n// --------- TEXTO EXACTO QUE SE MUESTRA EN EL DASHBOARD ---------\n\nlet texto = `Coordenadas: (${x},${y}) - rgb(${rgb[0]}, ${rgb[1]}, ${rgb[2]}) - ${hex} - C:${C} M:${M} Y:${Y} K:${K} W:${W}`;\n\n// --------- Salida 1: colour picker (solo HEX) ---------\nlet msgColor = { payload: hex };\n\n// --------- Salida 2: dashboard con texto completo ---------\nlet msgDashboard = { payload: texto };\n\n// Devolver SOLO dos salidas como pediste\nreturn [msgColor, msgDashboard];\n",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 140,
        "wires": [
            [
                "dd2edb522d0b6d6d"
            ],
            [
                "a59d349c2cab406f"
            ]
        ]
    },
    {
        "id": "a59d349c2cab406f",
        "type": "mqtt out",
        "z": "633db782b5e59011",
        "name": "",
        "topic": "esp/out",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "d93d769ab134dcae",
        "x": 760,
        "y": 160,
        "wires": []
    },
    {
        "id": "4424c4ebe29a6178",
        "type": "mqtt in",
        "z": "633db782b5e59011",
        "name": "",
        "topic": "camara/pi",
        "qos": "0",
        "datatype": "auto-detect",
        "broker": "138c9e1c6a6f1c8e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 140,
        "wires": [
            [
                "8c8ae91da1be57e6"
            ]
        ]
    },
    {
        "id": "e53f60cbcb6d90e9",
        "type": "ui_button",
        "z": "633db782b5e59011",
        "name": "",
        "group": "0dbc51b5a13e11e4",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Tomar foto",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "capturar",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 240,
        "wires": [
            [
                "dae8f93a92344ed6",
                "1ec6af16865437f9"
            ]
        ]
    },
    {
        "id": "dae8f93a92344ed6",
        "type": "mqtt out",
        "z": "633db782b5e59011",
        "name": "",
        "topic": "camara/captura",
        "qos": "0",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "138c9e1c6a6f1c8e",
        "x": 760,
        "y": 240,
        "wires": []
    },
    {
        "id": "1ec6af16865437f9",
        "type": "debug",
        "z": "633db782b5e59011",
        "name": "debug 5",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 740,
        "y": 300,
        "wires": []
    },
    {
        "id": "2bad93546c7c204b",
        "type": "exec",
        "z": "633db782b5e59011",
        "command": "python3 /home/hediy/proyecto_camara/scripts/camera_trigger.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "Ejecutar_camera_trigger",
        "x": 410,
        "y": 40,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "073de355e7d8bd14",
        "type": "inject",
        "z": "633db782b5e59011",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 40,
        "wires": [
            [
                "2bad93546c7c204b"
            ]
        ]
    },
    {
        "id": "dd2edb522d0b6d6d",
        "type": "ui_colour_picker",
        "z": "633db782b5e59011",
        "name": "",
        "label": "",
        "group": "0dbc51b5a13e11e4",
        "format": "hex",
        "outformat": "string",
        "showSwatch": true,
        "showPicker": false,
        "showValue": false,
        "showHue": false,
        "showAlpha": false,
        "showLightness": true,
        "square": "false",
        "dynOutput": "false",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "className": "",
        "x": 770,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "89832025f867af08",
        "type": "global-config",
        "env": [],
        "modules": {
            "node-red-dashboard": "3.6.6",
            "@flowfuse/node-red-dashboard": "1.29.0",
            "node-red-contrib-camerapi": "0.0.39",
            "node-red-contrib-ui-led": "0.4.11",
            "node-red-contrib-ui-level": "0.1.46",
            "@studiobox/node-red-contrib-ui-widget-thermometer": "0.7.7"
        }
    }
]